/*
 * If not stated otherwise in this file or this component's Licenses.txt file the
 * following copyright and licenses apply:
 *
 * Copyright 2015 RDK Management
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
*/

/**********************************************************************
   Copyright [2014] [Cisco Systems, Inc.]
 
   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at
 
       http://www.apache.org/licenses/LICENSE-2.0
 
   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
**********************************************************************/

/**********************************************************************

    MODULE: ca_entity_interface.h

        ASN.1 ANSC Code Generated by Cisco Systems, Inc.

    ---------------------------------------------------------------

    DESCRIPTION:

        This interface is for the entity of PKI implementation.

        This entity is for a CA object which probably include the crl.

    ---------------------------------------------------------------

    ENVIRONMENT:

        platform independent

    ---------------------------------------------------------------

    AUTHOR:

        Bin Zhu

    ---------------------------------------------------------------

    REVISION HISTORY:

        *   09/06/2002  initial revision
        *   07/16/2003  add function to export PKCS7 encode
        *   11/25/2003  add fields about CRL info
        *   12/01/2003  add name field support

 **********************************************************************/


#ifndef  _CA_ENTITY_INTERFACE_H
#define  _CA_ENTITY_INTERFACE_H


#define  MAXI_CRL_URL_LENGTH                    64

typedef ANSC_STATUS
(*CA_REMOVE)
    (
        ANSC_HANDLE                 hThisObject
    );

/**************************************************************
 *  Get handle
 **************************************************************/
typedef ANSC_HANDLE
(*CA_GET_HANDLE)
    (
        ANSC_HANDLE                 hThisObject
    );

typedef BOOLEAN
(*CA_IS_SAME)
    (
        ANSC_HANDLE                 hThisObject,
        PUCHAR                      pEncodingCert,
        ULONG                       length
    );

typedef ANSC_STATUS
(*CA_SET_HANDLE)
    (
        ANSC_HANDLE                 hThisObject,
        PUCHAR                      pEncoding,
        ULONG                       length
    );

typedef ANSC_STATUS
(*CA_VERIFY_CHILD)
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChildCert,
        ULONG                       pathIndex,
        BOOLEAN                     bCheckCRLOnly
    );

typedef PUCHAR
(*CA_EXPORT_PKCS7)
    (
        ANSC_HANDLE                 hThisObject,
        PULONG                      pLength
    );

typedef PCHAR
(*CA_GET_STRING)
    (
        ANSC_HANDLE                 hThisObject
    );

typedef ANSC_STATUS
(*CA_SET_STRING)
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pString
    );

typedef ULONG
(*CA_GET_ULONG)
    (
        ANSC_HANDLE                 hThisObject
    );

typedef void
(*CA_SET_ULONG)
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       uValue
    );

#define  CA_ENTITY_CLASS_CONTENT                                      \
    /* start of object class content */                               \
    SINGLE_LINK_ENTRY               Linkage;                          \
    ANSC_HANDLE                     hContainerContext;                \
    ANSC_HANDLE                     hCertHandle;                      \
    ANSC_HANDLE                     hCRLHandle;                       \
    CHAR                            pName[MAXI_ENTITY_NAME_BUFFER];   \
    PUCHAR                          pCertEncoding;                    \
    ULONG                           uLength;                          \
    CHAR                            pCRLAddress[MAXI_CRL_URL_LENGTH]; \
    ULONG                           uCRLPeriodInHours;                \
    ULONG                           uLastCRLTime;                     \
                                                                      \
    CA_REMOVE                       Remove;                           \
    CA_REMOVE                       RemoveCRL;                        \
    CA_GET_HANDLE                   GetCertHandle;                    \
    CA_GET_HANDLE                   GetCRLHandle;                     \
    CA_SET_HANDLE                   SetCRLHandle;                     \
    CA_VERIFY_CHILD                 VerifyChild;                      \
    CA_EXPORT_PKCS7                 ExportPkcs7Encode;                \
    CA_IS_SAME                      IsSameCert;                       \
    CA_GET_STRING                   GetName;                          \
    CA_SET_STRING                   SetName;                          \
    CA_GET_STRING                   GetCRLAddress;                    \
    CA_SET_STRING                   SetCRLAddress;                    \
    CA_GET_ULONG                    GetCRLPeriod;                     \
    CA_SET_ULONG                    SetCRLPeriod;                     \
    /* end of object class content */                                 \


typedef  struct
_CA_ENTITY
{
    CA_ENTITY_CLASS_CONTENT
}
CA_ENTITY,  *PCA_ENTITY;

#define  ACCESS_CA_ENTITY(p)    \
         ACCESS_CONTAINER(p, CA_ENTITY, Linkage)


#endif  /*_CA_ENTITY_INTERFACE_H*/


