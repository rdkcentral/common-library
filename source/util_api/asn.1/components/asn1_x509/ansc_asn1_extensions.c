/*
 * If not stated otherwise in this file or this component's Licenses.txt file the
 * following copyright and licenses apply:
 *
 * Copyright 2015 RDK Management
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
*/

/**********************************************************************
   Copyright [2014] [Cisco Systems, Inc.]
 
   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at
 
       http://www.apache.org/licenses/LICENSE-2.0
 
   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
**********************************************************************/

/**********************************************************************

    MODULE: ansc_asn1_Extensions.c

        ASN.1 ANSC Code Generated by Cisco Systems, Inc.

    ---------------------------------------------------------------

    DESCRIPTION:

        The ASN.1 objects implemented in this file

        *   ANSC_ASN1_EXTENSIONS
        *   ANSC_ASN1_EXTENSION
        *   ANSC_ASN1_AUTHORITYKEYIDENTIFIER
        *   ANSC_ASN1_KEYIDENTIFIER
        *   ANSC_ASN1_GENERALNAMES
        *   ANSC_ASN1_GENERALNAME
        *   ANSC_ASN1_ORADDRESS
        *   ANSC_ASN1_EDIPARTYNAME
        *   ANSC_ASN1_KEYUSAGE
        *   ANSC_ASN1_EXTKEYUSAGESYNTAX
        *   ANSC_ASN1_BASICCONSTRAINTS
        *   ANSC_ASN1_PRIVATEKEYUSAGEPERIOD
        *   ANSC_ASN1_CERTIFICATEPOLICIES
        *   ANSC_ASN1_POLICYINFORMATION
        *   ANSC_ASN1_POLICYQUALIFIERS
        *   ANSC_ASN1_POLICYQUALIFIERINFO
        *   ANSC_ASN1_POLICYQUALIFIER
        *   ANSC_ASN1_USERNOTICE
        *   ANSC_ASN1_NOTICEREFERENCE
        *   ANSC_ASN1_DISPLAYTEXT
        *   ANSC_ASN1_POLICYMAPPINGS
        *   ANSC_ASN1_NAMECONSTRAINTS
        *   ANSC_ASN1_GENERALSUBTREES
        *   ANSC_ASN1_GENERALSUBTREE
        *   ANSC_ASN1_POLICYCONSTRAINTS
        *   ANSC_ASN1_SUBJECTDIRECTORYATTRIBUTES
        *   ANSC_ASN1_CRLNUMBER
        *   ANSC_ASN1_CRLDISTPOINTSSYNTAX
        *   ANSC_ASN1_DISTRIBUTIONPOINT
        *   ANSC_ASN1_DISTRIBUTIONPOINTNAME
        *   ANSC_ASN1_REASONFLAGS
        *   ANSC_ASN1_ISSUINGDISTRIBUTIONPOINT
        *   ANSC_ASN1_AUTHORITYINFOACCESSSYNTAX
        *   ANSC_ASN1_ACCESSDESCRIPTION
        *   ANSC_ASN1_CRLREASON
        *   ANSC_ASN1_HOLDINSTRUCTIONCODE
        *   ANSC_ASN1_INVALIDITYDATE
        *   ANSC_ASN1_POLICYMAPPING
        *   ANSC_ASN1_NOTICENUMBERS
        *   ANSC_ASN1_DELTACRLINDICATOR
        *   ANSC_ASN1_ATTRIBUTESSYNTAX
        *   ANSC_ASN1_BIOMETRICSSYNTAX
        *   ANSC_ASN1_BIOMETRICDATA
        *   ANSC_ASN1_TYPEOFBIOMETRICDATA
        *   ANSC_ASN1_QCSTATEMENTSSYNTAX
        *   ANSC_ASN1_QCSTATEMENT
        *   ANSC_ASN1_ENTRUSTVERSIONINFO
        *   ANSC_ASN1_EXTENSIONVALUE


    ---------------------------------------------------------------

    ENVIRONMENT:

        platform independent

    ---------------------------------------------------------------

    AUTHOR:

        ASNMAGIC ANSC CODE GENERATOR 1.0

    ---------------------------------------------------------------

    REVISION HISTORY:

        *   05/07/2002  initial revision
        *   05/08/2002  add more apis for EXTENSION object

 **********************************************************************/


#include "ansc_asn1_advanced_local.h"

/**********************************************************************

 OBJECT -- ANSC_ASN1_EXTENSIONS

 Extensions ::= SequenceOf Extension  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateExtensions
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_EXTENSIONS           pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    if( hReserved != NULL)
    {
        pThisObject = (PANSC_ASN1_EXTENSIONS)
            AnscAsn1CreateSequenceOf
                (
                    hReserved
                );
    }
    else
    {
        pThisObject = (PANSC_ASN1_EXTENSIONS)
            AnscAsn1CreateSequenceOf
                (
                    (ANSC_HANDLE)sizeof(ANSC_ASN1_EXTENSIONS)
                );
    }

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_EXTENSIONS");
    pThisObject->SetName(pThisObject, "Extensions");

    pThisObject->Create             = AnscAsn1CreateExtensions;
    pThisObject->CreateChild        = AnscAsn1ExtensionsCreateChild;
    pThisObject->IsChildValid       = AnscAsn1ExtensionsIsChildValid;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1ExtensionsCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreateExtension(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1ExtensionsIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_EXTENSION", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_EXTENSION

 Extension ::= Sequence 
     {
                            extnID OID 
                          critical BOOL 
                         extnValue OctetString 
         EXTRA:
                     extensionValue ExtensionValue 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateExtension
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_EXTENSION            pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_EXTENSION)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_EXTENSION)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_EXTENSION");
    pThisObject->SetName(pThisObject, "Extension");

    pThisObject->Create             = AnscAsn1CreateExtension;
    pThisObject->CreateChildAttr    = AnscAsn1ExtensionCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1ExtensionGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1ExtensionCreateChildObject;
    pThisObject->CreateExtraChild   = AnscAsn1ExtensionCreateExtraChild;
    pThisObject->GetExtraChildName  = AnscAsn1ExtensionGetExtraChildName;

    pThisObject->IsCritical         = AnscAsn1ExtensionIsCritical;
    pThisObject->GetExtensionType   = AnscAsn1ExtensionGetExtensionType;

    pThisObject->uTotalChild        = 3;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1ExtensionCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateOID(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateBOOL(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 2:

            pThisObject = AnscAsn1CreateOctetString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1ExtensionCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
UNREFERENCED_PARAMETER(index);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

PCHAR
AnscAsn1ExtensionGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( index )
    {
        case 0:

            return"extnID";

        case 1:

            return"critical";

        case 2:

            return"extnValue";

    }

    return "";

}

ANSC_HANDLE
AnscAsn1ExtensionCreateExtraChild
    (
        ANSC_HANDLE                 hThisObject
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    return AnscAsn1CreateExtensionValue(NULL);

}

PCHAR
AnscAsn1ExtensionGetExtraChildName
    (
        ANSC_HANDLE                 hThisObject
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    return "extensionValue";

}

/*
 *  Manually added functions;
 */
BOOLEAN
AnscAsn1ExtensionGetExtensionType
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pOIDString
    )
{
    PANSC_ASN1_EXTENSION            pThisObject  = (PANSC_ASN1_EXTENSION)hThisObject;
    PANSC_ASN1_OIDEN                pOIDObject;

    if( hThisObject == NULL || pOIDString == NULL)
    {
        return FALSE;
    }

    pOIDObject = (PANSC_ASN1_OIDEN)pThisObject->GetChildByIndex(pThisObject,0);


    return pOIDObject->GetStringOIDValue(pOIDObject, pOIDString);
}
        
BOOLEAN
AnscAsn1ExtensionIsCritical
    (
        ANSC_HANDLE                 hThisObject
    )
{
    PANSC_ASN1_EXTENSION            pThisObject  = (PANSC_ASN1_EXTENSION)hThisObject;
    PANSC_ASN1_BOOL                 pBoolObject;

    if( hThisObject == NULL)
    {
        return FALSE;
    }

    pBoolObject = (PANSC_ASN1_BOOL)pThisObject->GetChildByIndex(pThisObject,1);

    if( pBoolObject == NULL || pBoolObject->bOptional)
    {
        return FALSE;
    }

    return pBoolObject->GetBooleanValue(pBoolObject);
}


ANSC_HANDLE
AnscAsn1ExtensionGenerate
    (
        ANSC_HANDLE                 hReserved,
        PCHAR                       pOIDString,
        BOOLEAN                     bIsCritical,
        ANSC_HANDLE                 hExtValue
    )
{
    PANSC_ASN1_EXTENSION            pThisObject  = NULL;
    PANSC_ASN1_OBJECT               pExtValue    = (PANSC_ASN1_OBJECT)hExtValue;
    PANSC_ASN1_BOOL                 pCritical;
    PANSC_ASN1_OIDEN                pOIDObject;
    PANSC_ASN1_STRING               pStringObject;
    PCHAR                           pBuffer      = NULL;
    PCHAR                           pBack        = NULL;
    LONG                            length;
    PANSC_ASN1_CHOICE               pExtra;

    if( pOIDString == NULL || hExtValue == NULL)
    {
        return NULL;
    }

    pThisObject = (PANSC_ASN1_EXTENSION)
        AnscAsn1CreateExtension(hReserved);

    if( pThisObject == NULL)
    {
        return NULL;
    }

    /* set the OID value */
    pOIDObject = (PANSC_ASN1_OIDEN)pThisObject->GetChildByIndex(pThisObject,0);

    if( pOIDObject != NULL)
    {
        pOIDObject->SetStringOIDValue(pOIDObject, pOIDString);
    }

    /* set the critical value */
    pCritical = (PANSC_ASN1_BOOL)pThisObject->GetChildByIndex(pThisObject,1);

    if( pCritical != NULL)
    {
        if( !bIsCritical)
        {
            /* set as optional, use default value "FALSE" */
            pCritical->bOptional = TRUE;
        }
        else
        {
            pCritical->bOptional = FALSE;

            pCritical->SetBooleanValue(pCritical, TRUE);
        }
    }

    /* Set the extension value */
    length = pExtValue->GetSizeOfEncoded(pExtValue);

    if( length < 0)
    {
        goto FAILED;
    }

    if( length > 0)
    {
        pBuffer = AnscAllocateMemory(length + 4);
        
        if( pBuffer == NULL)
        {
            goto FAILED;
        }

        pBack = pBuffer;

        if( ANSC_STATUS_SUCCESS != pExtValue->EncodingData(pExtValue, (PVOID*)&pBack))
        {
            AnscFreeMemory(pBuffer);

            goto FAILED;
        }

        /* set to the string value */
        pStringObject = (PANSC_ASN1_STRING)pThisObject->GetChildByIndex(pThisObject,2);

        if( pStringObject != NULL)
        {
            pStringObject->SetStringValue(pStringObject, (PUCHAR)pBuffer, length);
        }

        AnscFreeMemory(pBuffer);
    }

    /* Set the special child */
    pExtra = (PANSC_ASN1_CHOICE)pThisObject->CreateExtraChild(pThisObject);

    if( pExtra != NULL)
    {
        pThisObject->SetExtraChild(pThisObject, pExtra, TRUE);

        pExtra->SetSelection
            (
                pExtra, 
                pExtra->GetChoiceFromOID(pExtra,pOIDString), 
                hExtValue);
    }

    return pThisObject;

FAILED:

    if( pThisObject != NULL)
    {
        pThisObject->AsnFree(pThisObject);
    }

    return NULL;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_AUTHORITYKEYIDENTIFIER

 AuthorityKeyIdentifier ::= Sequence 
     {
                     keyIdentifier [CON 0] IMP KeyIdentifier OPT
               authorityCertIssuer [CON 1] IMP GeneralNames OPT
                      serialNumber [CON 2] IMP Integer OPT
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateAuthorityKeyIdentifier
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_AUTHORITYKEYIDENTIFIER 
                                    pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_AUTHORITYKEYIDENTIFIER)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_AUTHORITYKEYIDENTIFIER)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_AUTHORITYKEYIDENTIFIER");
    pThisObject->SetName(pThisObject, "AuthorityKeyIdentifier");

    pThisObject->Create             = AnscAsn1CreateAuthorityKeyIdentifier;
    pThisObject->CreateChildAttr    = AnscAsn1AuthorityKeyIdentifierCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1AuthorityKeyIdentifierGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1AuthorityKeyIdentifierCreateChildObject;
    pThisObject->uTotalChild        = 3;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1AuthorityKeyIdentifierCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateKeyIdentifier(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateGeneralNames(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 2:

            pThisObject = AnscAsn1CreateInteger(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1AuthorityKeyIdentifierCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    switch ( index )
    {
        case 0:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          0,
                          IMPLICIT_TYPE
                        );

                break;

        case 1:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          1,
                          IMPLICIT_TYPE
                        );

                break;

        case 2:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          2,
                          IMPLICIT_TYPE
                        );

                break;

    }

    return pAttrObject;

}

PCHAR
AnscAsn1AuthorityKeyIdentifierGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( index )
    {
        case 0:

            return"keyIdentifier";

        case 1:

            return"authorityCertIssuer";

        case 2:

            return"serialNumber";

    }

    return "";

}


/**********************************************************************

 OBJECT -- ANSC_ASN1_KEYIDENTIFIER

 KeyIdentifier ::= OctetString 

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateKeyIdentifier
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_KEYIDENTIFIER        pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_KEYIDENTIFIER)
        AnscAsn1CreateOctetString
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_KEYIDENTIFIER");
    pThisObject->SetName(pThisObject, "KeyIdentifier");

    pThisObject->Create             = AnscAsn1CreateKeyIdentifier;

    return (ANSC_HANDLE)pThisObject;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_GENERALNAMES

 GeneralNames ::= SequenceOf GeneralName  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateGeneralNames
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_GENERALNAMES         pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_GENERALNAMES)
        AnscAsn1CreateSequenceOf
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_GENERALNAMES)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_GENERALNAMES");
    pThisObject->SetName(pThisObject, "GeneralNames");

    pThisObject->Create             = AnscAsn1CreateGeneralNames;
    pThisObject->CreateChild        = AnscAsn1GeneralNamesCreateChild;
    pThisObject->IsChildValid       = AnscAsn1GeneralNamesIsChildValid;

    pThisObject->AddAltName         = AnscAsn1GeneralNamesAddAltName;
    pThisObject->AddKb5Name         = AnscAsn1GeneralNamesAddKb5Name;
    pThisObject->GetKB5Name         = AnscAsn1GeneralNamesGetKB5Name;
    pThisObject->GetAltNameByMask   = AnscAsn1GeneralNamesGetAltNameByMask;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1CreateGeneralNamesWithAltName
    (
        ANSC_HANDLE                 hReserved,
        PCHAR                       pAltName
    )
{
    PANSC_ASN1_GENERALNAMES         pThisObject  = NULL;

    pThisObject = (PANSC_ASN1_GENERALNAMES)
        AnscAsn1CreateGeneralNames(hReserved);

    if( pThisObject == NULL || pAltName == NULL)
    {
        return pThisObject;
    }

    if(!pThisObject->AddAltName(pThisObject, pAltName))
    {
        AnscTrace("Invalid SubjectAltName : '%s'\n", pAltName);

        pThisObject->AsnFree(pThisObject);

        return NULL;
    }

    return pThisObject;
}

ANSC_HANDLE
AnscAsn1CreateGeneralNamesWithKerberosName
    (
        ANSC_HANDLE                 hReserved,        
        ANSC_HANDLE                 hRealmName,
        ANSC_HANDLE                 hPrinName
    )
{
    PANSC_ASN1_GENERALNAMES         pThisObject  = NULL;

    pThisObject = (PANSC_ASN1_GENERALNAMES)
        AnscAsn1CreateGeneralNames(hReserved);

    if( pThisObject == NULL || hRealmName == NULL || hPrinName == NULL)
    {
        return pThisObject;
    }

    if(!pThisObject->AddKb5Name(pThisObject, hRealmName, hPrinName))
    {
        AnscTrace("Failed to add the KB5 Name.\n");

        pThisObject->AsnFree(pThisObject);

        return NULL;
    }

    return pThisObject;
}


ANSC_HANDLE
AnscAsn1GeneralNamesCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreateGeneralName(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1GeneralNamesIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_GENERALNAME", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/*
 *  Manually added functions;
 */
BOOLEAN
AnscAsn1GeneralNamesAddKb5Name
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hRealmName,
        ANSC_HANDLE                 hPrinName
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(hRealmName);
    UNREFERENCED_PARAMETER(hPrinName);
#ifndef _NO_PKI_KB5_SUPPORT
    PKB5_PRINNAME_STRUCTURE         pPrinInfo   = (PKB5_PRINNAME_STRUCTURE)hPrinName;
    PKB5_REALM_STRUCTURE            pRealm      = (PKB5_REALM_STRUCTURE)hRealmName;
    PANSC_ASN1_GENERALNAME          pGeneralName;
    PANSC_ASN1_OTHERNAME            pOtherName;
    PANSC_ASN1_OTHERSTRING          pOtherString;
    PANSC_ASN1_OIDEN                pOIDObj;
    PANSC_ASN1_SEQUENCE             pKB5Obj;
    PANSC_ASN1_OBJECT               pValueObj;

    if( hThisObject == NULL ||hPrinName == NULL || hRealmName == NULL)
    {
        return FALSE;
    }

    /* init the principal name */
    pOtherName = (PANSC_ASN1_OTHERNAME)AnscAsn1CreateOtherName(NULL);

    if( pOtherName == NULL)
    {
        goto EXIT;
    }

    pOIDObj = (PANSC_ASN1_OIDEN)pOtherName->GetChildByIndex(pOtherName, 0);

    if( pOIDObj != NULL)
    {
        /* krb5PrincipalName oid  : "1.3.6.1.5.2.2" */
        pOIDObj->SetStringOIDValue(pOIDObj, "1.3.6.1.5.2.2");
    }

    pOtherString = (PANSC_ASN1_OTHERSTRING)pOtherName->GetChildByIndex(pOtherName, 1);
    pOtherString->SetAndCreateSelection(pOtherString, OTHERSTRING_MASK_KERBEROS);

    /* init the KB5 name */
    pKB5Obj = (PANSC_ASN1_SEQUENCE)pOtherString->hSelection;

    if( pKB5Obj == NULL)
    {
        pOtherName->AsnFree(pOtherName);

        goto EXIT;
    }

    /* the realm */
    pValueObj = (PANSC_ASN1_OBJECT)pKB5Obj->GetChildByIndex(pKB5Obj, 0);

    if( pValueObj != NULL)
    {
        KB5UtilitySetRealmName(pValueObj, hRealmName);
    }

    /* the principal name */
    pValueObj = (PANSC_ASN1_OBJECT)pKB5Obj->GetChildByIndex(pKB5Obj, 1);

    if( pValueObj != NULL)
    {
        KB5UtilitySetPrincipalName(pValueObj, hPrinName);
    }

    /* create the general name */
    pGeneralName = (PANSC_ASN1_GENERALNAME)AnscAsn1CreateGeneralName(NULL);

    if( pGeneralName == NULL)
    {
        pOtherName->AsnFree(pOtherName);

        goto EXIT;
    }

    pGeneralName->SetSelection
        (
            pGeneralName, 
            GENERALNAME_MASK_OTHERNAME,
            pOtherName
        );

    pThisObject->AddChild(pThisObject, pGeneralName);        

    return TRUE;

EXIT:

#endif

    return FALSE;
}

BOOLEAN
AnscAsn1GeneralNamesAddAltName
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pAltName
    )
{
    PANSC_ASN1_GENERALNAMES         pThisObject  = (PANSC_ASN1_GENERALNAMES)hThisObject;
    PPKI_ALTNAME_PARSER             pAltParser;
    PCHAR                           pValue;
    PANSC_ASN1_OCTETSTRING          pOctetString;
    PANSC_ASN1_IA5STRING            pIA5String;
    PANSC_ASN1_GENERALNAME          pGeneralName;
    ULONG                           i, type;

    if( pThisObject == NULL || pAltName == NULL || AnscSizeOfString(pAltName) <= 0)
    {
        return FALSE;
    }

    pAltParser = (PPKI_ALTNAME_PARSER)PKIParsingAltName(pAltName);
    
    if( pAltParser == NULL)
    {
        return FALSE;
    }

    for( i = 0; i < pAltParser->GetTotalBlock(pAltParser); i ++)
    {
        type  = pAltParser->GetBlockType(pAltParser, i);
        pValue= (PCHAR)pAltParser->GetBlockValue(pAltParser, i);

        if( type != ALT_TYPE_IP_NAME)
        {
            pIA5String =(PANSC_ASN1_IA5STRING)AnscAsn1CreateIA5String(NULL);

            if( pIA5String == NULL)
            {
                return FALSE;
            }

            pIA5String->SetStringValue(pIA5String, (PUCHAR)pValue, AnscSizeOfString(pValue));

            pGeneralName = (PANSC_ASN1_GENERALNAME)AnscAsn1CreateGeneralName(NULL);

            if( pGeneralName == NULL)
            {
                pIA5String->AsnFree(pIA5String);

                return FALSE;
            }

            if( type == ALT_TYPE_EMAIL_NAME)
            {
                pGeneralName->SetSelection
                    (
                        pGeneralName, 
                        GENERALNAME_MASK_RFC822NAME,
                        pIA5String
                    );
            }
            else if( type == ALT_TYPE_DNS_NAME)
            {
                pGeneralName->SetSelection
                    (
                        pGeneralName, 
                        GENERALNAME_MASK_DNSNAME,
                        pIA5String
                    );
            }
            else
            {
                pGeneralName->SetSelection
                    (
                        pGeneralName, 
                        GENERALNAME_MASK_URI,
                        pIA5String
                    );
            }

            pThisObject->AddChild(pThisObject, pGeneralName);        
        }
        else
        {
            pOctetString =(PANSC_ASN1_OCTETSTRING)AnscAsn1CreateOctetString(NULL);

            if( pOctetString == NULL)
            {
                return FALSE;
            }

            pOctetString->SetStringValue
                (
                    pOctetString, 
                    (PUCHAR)(pValue + 1),
                    (ULONG)pValue[0]
                );

            pGeneralName = (PANSC_ASN1_GENERALNAME)AnscAsn1CreateGeneralName(NULL);

            if( pGeneralName == NULL)
            {
                pOctetString->AsnFree(pOctetString);

                return FALSE;
            }

            pGeneralName->SetSelection
                (
                    pGeneralName, 
                    GENERALNAME_MASK_IPADDRESS,
                    pOctetString
                );

            pThisObject->AddChild(pThisObject, pGeneralName);        
        }

    }

    pAltParser->Remove(pAltParser);

    return TRUE;
}

ANSC_STATUS
AnscAsn1GeneralNamesGetKB5Name
    (
        ANSC_HANDLE                 hThisObject,        
        ANSC_HANDLE                 hRealmName,
        ANSC_HANDLE                 hPrinName
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(hRealmName);
    UNREFERENCED_PARAMETER(hPrinName);

#ifndef _NO_PKI_KB5_SUPPORT
    
    PANSC_ASN1_GENERALNAME          pGeneralName;
    PANSC_ASN1_OTHERNAME            pOtherName;
    PANSC_ASN1_OTHERSTRING          pOtherString;
    PANSC_ASN1_SEQUENCE             pKB5Obj;
    PANSC_ASN1_OBJECT               pValueObj;
    ULONG                           i;

    if( hThisObject == NULL || hPrinName == NULL || hRealmName == NULL)
    {
        return ANSC_STATUS_FAILURE;
    }

    for( i = 0; i < pThisObject->GetChildCount(pThisObject);  i ++)
    {
        pGeneralName = (PANSC_ASN1_GENERALNAME)
            pThisObject->GetChildByIndex(pThisObject, i);

        if( pGeneralName != NULL &&
              pGeneralName->lSelect == GENERALNAME_MASK_OTHERNAME)
        {
            pOtherName = (PANSC_ASN1_OTHERNAME)pGeneralName->hSelection;

            if( pOtherName == NULL)
            {
                return ANSC_STATUS_FAILURE;
            }

            pOtherString = (PANSC_ASN1_OTHERSTRING)
                pOtherName->GetChildByIndex(pOtherName, 1);

            if( pOtherString == NULL || pOtherString->lSelect != OTHERSTRING_MASK_KERBEROS)
            {
                return ANSC_STATUS_FAILURE;
            }

            pKB5Obj = (PANSC_ASN1_SEQUENCE)pOtherString->hSelection;
    
            if( pKB5Obj == NULL)
            {
                return ANSC_STATUS_FAILURE;
            }

            /* get the value */
            pValueObj = (PANSC_ASN1_OBJECT)pKB5Obj->GetChildByIndex(pKB5Obj, 0);

            if( pValueObj != NULL)
            {
                KB5UtilityGetRealmName(pValueObj, hRealmName);
            }

            pValueObj = (PANSC_ASN1_OBJECT)pKB5Obj->GetChildByIndex(pKB5Obj, 1);

            if( pValueObj != NULL)
            {
                KB5UtilityGetPrincipalName(pValueObj, hPrinName);
            }

            return ANSC_STATUS_SUCCESS;
        }
    }

#endif

    return ANSC_STATUS_FAILURE;
}

ANSC_STATUS
AnscAsn1GeneralNamesGetAltNameByMask
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       typeMask,
        PUCHAR                      pOutBuffer,
        PULONG                      pLength
    )
{
    PANSC_ASN1_GENERALNAMES         pThisObject  = (PANSC_ASN1_GENERALNAMES)hThisObject;
    PANSC_ASN1_GENERALNAME          pNameObject;
    ULONG                           i;
    PANSC_ASN1_OBJECT               pValueObj;
    PANSC_ASN1_STRING               pStrObj;

    if( hThisObject == NULL || pOutBuffer == NULL || pLength == NULL)
    {
        return ANSC_STATUS_FAILURE;
    }

    if( typeMask  == GENERALNAME_MASK_OTHERNAME     ||
        typeMask  == GENERALNAME_MASK_X400ADDRESS   ||
        typeMask  == GENERALNAME_MASK_DIRECTORYNAME ||
        typeMask  == GENERALNAME_MASK_EDIPARTYNAME  ||
        typeMask  == GENERALNAME_MASK_REGISTEREDID)
    {
        return ANSC_STATUS_FAILURE;
    }

    for( i = 0; i < pThisObject->GetChildCount(pThisObject); i ++)
    {
        pNameObject = (PANSC_ASN1_GENERALNAME)
            pThisObject->GetChildByIndex(pThisObject, i);

        if( pNameObject != NULL && pNameObject->lSelect == (LONG)typeMask)
        {
            pValueObj = (PANSC_ASN1_OBJECT)pNameObject->hSelection;

            while( pValueObj != NULL && IsObjectChoiceType(pValueObj->uType))
            {
                pValueObj = (PANSC_ASN1_OBJECT)
                    ((PANSC_ASN1_CHOICE)pValueObj)->hSelection;
            }
            
            pStrObj = (PANSC_ASN1_STRING)pValueObj;

            if( pStrObj == NULL || pStrObj->uLength > *pLength)
            {
                return ANSC_STATUS_FAILURE;
            }

            *pLength = pStrObj->uLength;

            AnscCopyMemory
              (
                 pOutBuffer,
                 pStrObj->GetValueBuffer(pStrObj),
                 *pLength
              );

            return ANSC_STATUS_SUCCESS;
        }
    }

    return ANSC_STATUS_FAILURE;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_GENERALNAME

 GeneralName ::= Choice 
     {
                         otherName [CON 0] IMP OtherName 
                        rfc822Name [CON 1] IMP IA5String 
                           dNSName [CON 2] IMP IA5String 
                       x400Address [CON 3] IMP ORAddress 
                     directoryName [CON 4] IMP Name 
                      ediPartyName [CON 5] IMP EDIPartyName 
                               uri [CON 6] IMP IA5String 
                         iPAddress [CON 7] IMP OctetString 
                      registeredID [CON 8] IMP OID 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateGeneralName
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_GENERALNAME          pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_GENERALNAME)
        AnscAsn1CreateChoice
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_GENERALNAME");
    pThisObject->SetName(pThisObject, "GeneralName");

    pThisObject->Create             = AnscAsn1CreateGeneralName;
    pThisObject->CreateSelection    = AnscAsn1GeneralNameCreateSelection;
    pThisObject->GetSelectionName   = AnscAsn1GeneralNameGetSelectionName;
    pThisObject->CreateSelectionAttr= AnscAsn1GeneralNameCreateSelectionAttr;
    pThisObject->GetChoiceTagValue  = AnscAsn1GeneralNameGetChoiceTagValue;
    pThisObject->uTotalChoice       = GENERALNAME_MAXI_MASK + 1;
    pThisObject->bChoiceByOID       = FALSE;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1GeneralNameCreateSelection
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_CHOICE               pParent         = (PANSC_ASN1_CHOICE)hThisObject;

    switch( index )
    {

        case GENERALNAME_MASK_OTHERNAME:

            pThisObject = AnscAsn1CreateOtherName(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case GENERALNAME_MASK_RFC822NAME:

            pThisObject = AnscAsn1CreateIA5String(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case GENERALNAME_MASK_DNSNAME:

            pThisObject = AnscAsn1CreateIA5String(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case GENERALNAME_MASK_X400ADDRESS:

            pThisObject = AnscAsn1CreateORAddress(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case GENERALNAME_MASK_DIRECTORYNAME:

            pThisObject = AnscAsn1CreateName(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case GENERALNAME_MASK_EDIPARTYNAME:

            pThisObject = AnscAsn1CreateEDIPartyName(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case GENERALNAME_MASK_URI:

            pThisObject = AnscAsn1CreateIA5String(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case GENERALNAME_MASK_IPADDRESS:

            pThisObject = AnscAsn1CreateOctetString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case GENERALNAME_MASK_REGISTEREDID:

            pThisObject = AnscAsn1CreateOID(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PCHAR
AnscAsn1GeneralNameGetSelectionName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( selType )
    {
        case GENERALNAME_MASK_OTHERNAME:

            return"otherName";

        case GENERALNAME_MASK_RFC822NAME:

            return"rfc822Name";

        case GENERALNAME_MASK_DNSNAME:

            return"dNSName";

        case GENERALNAME_MASK_X400ADDRESS:

            return"x400Address";

        case GENERALNAME_MASK_DIRECTORYNAME:

            return"directoryName";

        case GENERALNAME_MASK_EDIPARTYNAME:

            return"ediPartyName";

        case GENERALNAME_MASK_URI:

            return"uri";

        case GENERALNAME_MASK_IPADDRESS:

            return"iPAddress";

        case GENERALNAME_MASK_REGISTEREDID:

            return"registeredID";

    }

    return "";

}

PANSC_ATTR_OBJECT
AnscAsn1GeneralNameCreateSelectionAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    switch ( selType )
    {
        case GENERALNAME_MASK_OTHERNAME:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          0,
                          IMPLICIT_TYPE
                        );

                break;

        case GENERALNAME_MASK_RFC822NAME:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          1,
                          IMPLICIT_TYPE
                        );

                break;

        case GENERALNAME_MASK_DNSNAME:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          2,
                          IMPLICIT_TYPE
                        );

                break;

        case GENERALNAME_MASK_X400ADDRESS:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          3,
                          IMPLICIT_TYPE
                        );

                break;

        case GENERALNAME_MASK_DIRECTORYNAME:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          4,
                          IMPLICIT_TYPE
                        );

                break;

        case GENERALNAME_MASK_EDIPARTYNAME:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          5,
                          IMPLICIT_TYPE
                        );

                break;

        case GENERALNAME_MASK_URI:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          6,
                          IMPLICIT_TYPE
                        );

                break;

        case GENERALNAME_MASK_IPADDRESS:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          7,
                          IMPLICIT_TYPE
                        );

                break;

        case GENERALNAME_MASK_REGISTEREDID:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          8,
                          IMPLICIT_TYPE
                        );

                break;

    }

    return pAttrObject;

}

BOOLEAN
AnscAsn1GeneralNameGetChoiceTagValue
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       uIndex,
        PASN_OBJECT_FORM_TYPE       pAttr,
        PULONG                      pTagValue
    )
{
   UNREFERENCED_PARAMETER(hThisObject);
   if( pAttr == NULL || pTagValue == NULL)
    {
        return FALSE;
    }

    switch ( uIndex )
    {
        case GENERALNAME_MASK_OTHERNAME:

            *pAttr       = CONTEXT_FORM;
            *pTagValue   = 0;

            return TRUE;

        case GENERALNAME_MASK_RFC822NAME:

            *pAttr       = CONTEXT_FORM;
            *pTagValue   = 1;

            return TRUE;

        case GENERALNAME_MASK_DNSNAME:

            *pAttr       = CONTEXT_FORM;
            *pTagValue   = 2;

            return TRUE;

        case GENERALNAME_MASK_X400ADDRESS:

            *pAttr       = CONTEXT_FORM;
            *pTagValue   = 3;

            return TRUE;

        case GENERALNAME_MASK_DIRECTORYNAME:

            *pAttr       = CONTEXT_FORM;
            *pTagValue   = 4;

            return TRUE;

        case GENERALNAME_MASK_EDIPARTYNAME:

            *pAttr       = CONTEXT_FORM;
            *pTagValue   = 5;

            return TRUE;

        case GENERALNAME_MASK_URI:

            *pAttr       = CONTEXT_FORM;
            *pTagValue   = 6;

            return TRUE;

        case GENERALNAME_MASK_IPADDRESS:

            *pAttr       = CONTEXT_FORM;
            *pTagValue   = 7;

            return TRUE;

        case GENERALNAME_MASK_REGISTEREDID:

            *pAttr       = CONTEXT_FORM;
            *pTagValue   = 8;

            return TRUE;

    }

    return FALSE;

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_ORADDRESS

 ORAddress ::= OctetString 

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateORAddress
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_ORADDRESS            pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_ORADDRESS)
        AnscAsn1CreateOctetString
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_ORADDRESS");
    pThisObject->SetName(pThisObject, "ORAddress");

    pThisObject->Create             = AnscAsn1CreateORAddress;

    return (ANSC_HANDLE)pThisObject;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_EDIPARTYNAME

 EDIPartyName ::= Sequence 
     {
                      nameAssigner [CON 0] IMP DirectoryString OPT
                         partyName [CON 1] IMP DirectoryString 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateEDIPartyName
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_EDIPARTYNAME         pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_EDIPARTYNAME)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_EDIPARTYNAME)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_EDIPARTYNAME");
    pThisObject->SetName(pThisObject, "EDIPartyName");

    pThisObject->Create             = AnscAsn1CreateEDIPartyName;
    pThisObject->CreateChildAttr    = AnscAsn1EDIPartyNameCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1EDIPartyNameGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1EDIPartyNameCreateChildObject;
    pThisObject->uTotalChild        = 2;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1EDIPartyNameCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateDirectoryString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateDirectoryString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1EDIPartyNameCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    switch ( index )
    {
        case 0:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          0,
                          IMPLICIT_TYPE
                        );

                break;

        case 1:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          1,
                          IMPLICIT_TYPE
                        );

                break;

    }

    return pAttrObject;

}

PCHAR
AnscAsn1EDIPartyNameGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( index )
    {
        case 0:

            return"nameAssigner";

        case 1:

            return"partyName";

    }

    return "";

}


/**********************************************************************

 OBJECT -- ANSC_ASN1_KEYUSAGE

 KeyUsage ::= BitString 

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateKeyUsage
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_KEYUSAGE             pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_KEYUSAGE)
        AnscAsn1CreateBitString
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_KEYUSAGE");
    pThisObject->SetName(pThisObject, "KeyUsage");

    pThisObject->Create             = AnscAsn1CreateKeyUsage;

    return (ANSC_HANDLE)pThisObject;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_EXTKEYUSAGESYNTAX

 ExtKeyUsageSyntax ::= SequenceOf OID  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateExtKeyUsageSyntax
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_EXTKEYUSAGESYNTAX    pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_EXTKEYUSAGESYNTAX)
        AnscAsn1CreateSequenceOf
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_EXTKEYUSAGESYNTAX");
    pThisObject->SetName(pThisObject, "ExtKeyUsageSyntax");

    pThisObject->Create             = AnscAsn1CreateExtKeyUsageSyntax;
    pThisObject->CreateChild        = AnscAsn1ExtKeyUsageSyntaxCreateChild;
    pThisObject->IsChildValid       = AnscAsn1ExtKeyUsageSyntaxIsChildValid;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1ExtKeyUsageSyntaxCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreateOID(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1ExtKeyUsageSyntaxIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_OID", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    if( pChild->uType != 0x06)
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_BASICCONSTRAINTS

 BasicConstraints ::= Sequence 
     {
                                cA BOOL    DEF (FALSE) 
                 pathLenConstraint Integer OPT
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateBasicConstraints
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_BASICCONSTRAINTS     pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_BASICCONSTRAINTS)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_BASICCONSTRAINTS)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_BASICCONSTRAINTS");
    pThisObject->SetName(pThisObject, "BasicConstraints");

    pThisObject->Create             = AnscAsn1CreateBasicConstraints;
    pThisObject->CreateChildAttr    = AnscAsn1BasicConstraintsCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1BasicConstraintsGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1BasicConstraintsCreateChildObject;
    pThisObject->uTotalChild        = 2;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1BasicConstraintsCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateBOOL(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateInteger(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1BasicConstraintsCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(index);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

PCHAR
AnscAsn1BasicConstraintsGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( index )
    {
        case 0:

            return"cA";

        case 1:

            return"pathLenConstraint";

    }

    return "";

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_PRIVATEKEYUSAGEPERIOD

 PrivateKeyUsagePeriod ::= Sequence 
     {
                         notBefore [CON 0] IMP GeneralizedTime OPT
                          notAfter [CON 1] IMP GeneralizedTime OPT
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreatePrivateKeyUsagePeriod
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_PRIVATEKEYUSAGEPERIOD 
                                    pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_PRIVATEKEYUSAGEPERIOD)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_PRIVATEKEYUSAGEPERIOD)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_PRIVATEKEYUSAGEPERIOD");
    pThisObject->SetName(pThisObject, "PrivateKeyUsagePeriod");

    pThisObject->Create             = AnscAsn1CreatePrivateKeyUsagePeriod;
    pThisObject->CreateChildAttr    = AnscAsn1PrivateKeyUsagePeriodCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1PrivateKeyUsagePeriodGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1PrivateKeyUsagePeriodCreateChildObject;
    pThisObject->uTotalChild        = 2;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1PrivateKeyUsagePeriodCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateGeneralizedTime(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateGeneralizedTime(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1PrivateKeyUsagePeriodCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    switch ( index )
    {
        case 0:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          0,
                          IMPLICIT_TYPE
                        );

                break;

        case 1:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          1,
                          IMPLICIT_TYPE
                        );

                break;

    }

    return pAttrObject;

}

PCHAR
AnscAsn1PrivateKeyUsagePeriodGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( index )
    {
        case 0:

            return"notBefore";

        case 1:

            return"notAfter";

    }

    return "";

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_CERTIFICATEPOLICIES

 CertificatePolicies ::= SequenceOf PolicyInformation  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateCertificatePolicies
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_CERTIFICATEPOLICIES  pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_CERTIFICATEPOLICIES)
        AnscAsn1CreateSequenceOf
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_CERTIFICATEPOLICIES");
    pThisObject->SetName(pThisObject, "CertificatePolicies");

    pThisObject->Create             = AnscAsn1CreateCertificatePolicies;
    pThisObject->CreateChild        = AnscAsn1CertificatePoliciesCreateChild;
    pThisObject->IsChildValid       = AnscAsn1CertificatePoliciesIsChildValid;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1CertificatePoliciesCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreatePolicyInformation(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1CertificatePoliciesIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_POLICYINFORMATION", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_POLICYINFORMATION

 PolicyInformation ::= Sequence 
     {
                  policyIdentifier OID 
                  policyQualifiers PolicyQualifiers 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreatePolicyInformation
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_POLICYINFORMATION    pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_POLICYINFORMATION)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_POLICYINFORMATION)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_POLICYINFORMATION");
    pThisObject->SetName(pThisObject, "PolicyInformation");

    pThisObject->Create             = AnscAsn1CreatePolicyInformation;
    pThisObject->CreateChildAttr    = AnscAsn1PolicyInformationCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1PolicyInformationGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1PolicyInformationCreateChildObject;
    pThisObject->uTotalChild        = 2;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1PolicyInformationCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateOID(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreatePolicyQualifiers(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1PolicyInformationCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
UNREFERENCED_PARAMETER(index);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;


    return pAttrObject;

}

PCHAR
AnscAsn1PolicyInformationGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{  
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( index )
    {
        case 0:

            return"policyIdentifier";

        case 1:

            return"policyQualifiers";

    }

    return "";

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_POLICYQUALIFIERS

 PolicyQualifiers ::= SequenceOf PolicyQualifierInfo  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreatePolicyQualifiers
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_POLICYQUALIFIERS     pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_POLICYQUALIFIERS)
        AnscAsn1CreateSequenceOf
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_POLICYQUALIFIERS");
    pThisObject->SetName(pThisObject, "PolicyQualifiers");

    pThisObject->Create             = AnscAsn1CreatePolicyQualifiers;
    pThisObject->CreateChild        = AnscAsn1PolicyQualifiersCreateChild;
    pThisObject->IsChildValid       = AnscAsn1PolicyQualifiersIsChildValid;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1PolicyQualifiersCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreatePolicyQualifierInfo(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1PolicyQualifiersIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_POLICYQUALIFIERINFO", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_POLICYQUALIFIERINFO

 PolicyQualifierInfo ::= Sequence 
     {
                 policyQualifierID OID 
                         qualifier PolicyQualifier 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreatePolicyQualifierInfo
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_POLICYQUALIFIERINFO  pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_POLICYQUALIFIERINFO)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_POLICYQUALIFIERINFO)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_POLICYQUALIFIERINFO");
    pThisObject->SetName(pThisObject, "PolicyQualifierInfo");

    pThisObject->Create             = AnscAsn1CreatePolicyQualifierInfo;
    pThisObject->CreateChildAttr    = AnscAsn1PolicyQualifierInfoCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1PolicyQualifierInfoGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1PolicyQualifierInfoCreateChildObject;
    pThisObject->uTotalChild        = 2;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1PolicyQualifierInfoCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateOID(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreatePolicyQualifier(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1PolicyQualifierInfoCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(index);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

PCHAR
AnscAsn1PolicyQualifierInfoGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);   
    switch ( index )
    {
        case 0:

            return"policyQualifierID";

        case 1:

            return"qualifier";

    }

    return "";

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_POLICYQUALIFIER

 PolicyQualifier ::= Choice 
     {
                        userNotice UserNotice 
                            cpsuri IA5String 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreatePolicyQualifier
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_POLICYQUALIFIER      pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_POLICYQUALIFIER)
        AnscAsn1CreateChoice
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_POLICYQUALIFIER");
    pThisObject->SetName(pThisObject, "PolicyQualifier");

    pThisObject->Create             = AnscAsn1CreatePolicyQualifier;
    pThisObject->CreateSelection    = AnscAsn1PolicyQualifierCreateSelection;
    pThisObject->GetSelectionName   = AnscAsn1PolicyQualifierGetSelectionName;
    pThisObject->CreateSelectionAttr= AnscAsn1PolicyQualifierCreateSelectionAttr;
    pThisObject->GetChoiceFromOID   = AnscAsn1PolicyQualifierGetChoiceByOID;
    pThisObject->GetOIDValueByMask  = AnscAsn1PolicyQualifierGetOIDValueByMask;
    pThisObject->uTotalChoice       = POLICYQUALIFIER_MAXI_MASK + 1;
    pThisObject->bChoiceByOID       = TRUE;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1PolicyQualifierCreateSelection
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_CHOICE               pParent         = (PANSC_ASN1_CHOICE)hThisObject;

    switch( index )
    {

        case POLICYQUALIFIER_MASK_USERNOTICE:

            pThisObject = AnscAsn1CreateUserNotice(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case POLICYQUALIFIER_MASK_CPSURI:

            pThisObject = AnscAsn1CreateIA5String(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PCHAR
AnscAsn1PolicyQualifierGetSelectionName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( selType )
    {
        case POLICYQUALIFIER_MASK_USERNOTICE:

            return"userNotice";

        case POLICYQUALIFIER_MASK_CPSURI:

            return"cpsuri";

    }

   
    return "";

}

PANSC_ATTR_OBJECT
AnscAsn1PolicyQualifierCreateSelectionAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(selType);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

LONG
AnscAsn1PolicyQualifierGetChoiceByOID
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pOIDString
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    if( pOIDString == NULL)         return -1;

    if( AnscEqualString1(pOIDString,"1.3.6.1.5.5.7.2.2",FALSE))
    {
        return POLICYQUALIFIER_MASK_USERNOTICE;
    }
    else if( AnscEqualString1(pOIDString,"1.3.6.1.5.5.7.2.1",FALSE))
    {
        return POLICYQUALIFIER_MASK_CPSURI;
    }

    return -1;

}

PCHAR
AnscAsn1PolicyQualifierGetOIDValueByMask
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( selType )
    {
        case POLICYQUALIFIER_MASK_USERNOTICE:

             return "1.3.6.1.5.5.7.2.2";

        case POLICYQUALIFIER_MASK_CPSURI:

             return "1.3.6.1.5.5.7.2.1";

    }

    return NULL;

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_USERNOTICE

 UserNotice ::= Sequence 
     {
                         noticeRef NoticeReference 
                      explicitText DisplayText 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateUserNotice
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_USERNOTICE           pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_USERNOTICE)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_USERNOTICE)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_USERNOTICE");
    pThisObject->SetName(pThisObject, "UserNotice");

    pThisObject->Create             = AnscAsn1CreateUserNotice;
    pThisObject->CreateChildAttr    = AnscAsn1UserNoticeCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1UserNoticeGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1UserNoticeCreateChildObject;
    pThisObject->uTotalChild        = 2;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1UserNoticeCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateNoticeReference(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateDisplayText(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1UserNoticeCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(index);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

PCHAR
AnscAsn1UserNoticeGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( index )
    {
        case 0:

            return"noticeRef";

        case 1:

            return"explicitText";

    }

    return "";

}


/**********************************************************************

 OBJECT -- ANSC_ASN1_NOTICEREFERENCE

 NoticeReference ::= Sequence 
     {
                      organization DisplayText 
                     noticeNumbers NoticeNumbers 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateNoticeReference
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_NOTICEREFERENCE      pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_NOTICEREFERENCE)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_NOTICEREFERENCE)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_NOTICEREFERENCE");
    pThisObject->SetName(pThisObject, "NoticeReference");

    pThisObject->Create             = AnscAsn1CreateNoticeReference;
    pThisObject->CreateChildAttr    = AnscAsn1NoticeReferenceCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1NoticeReferenceGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1NoticeReferenceCreateChildObject;
    pThisObject->uTotalChild        = 2;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1NoticeReferenceCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateDisplayText(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateNoticeNumbers(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1NoticeReferenceCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(index);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

PCHAR
AnscAsn1NoticeReferenceGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( index )
    {
        case 0:

            return"organization";

        case 1:

            return"noticeNumbers";

    }

    return "";

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_DISPLAYTEXT

 DisplayText ::= Choice 
     {
                     visibleString VisibleString 
                         bmpString BMPString 
                        utf8String UTF8String 
                        ia5String  IA5String
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateDisplayText
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_DISPLAYTEXT          pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_DISPLAYTEXT)
        AnscAsn1CreateChoice
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_DISPLAYTEXT");
    pThisObject->SetName(pThisObject, "DisplayText");

    pThisObject->Create             = AnscAsn1CreateDisplayText;
    pThisObject->CreateSelection    = AnscAsn1DisplayTextCreateSelection;
    pThisObject->GetSelectionName   = AnscAsn1DisplayTextGetSelectionName;
    pThisObject->CreateSelectionAttr= AnscAsn1DisplayTextCreateSelectionAttr;
    pThisObject->GetChoiceTagValue  = AnscAsn1DisplayTextGetChoiceTagValue;
    pThisObject->uTotalChoice       = DISPLAYTEXT_MAXI_MASK + 1;
    pThisObject->bChoiceByOID       = FALSE;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1DisplayTextCreateSelection
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_CHOICE               pParent         = (PANSC_ASN1_CHOICE)hThisObject;

    switch( index )
    {

        case DISPLAYTEXT_MASK_VISIBLESTRING:

            pThisObject = AnscAsn1CreateVisibleString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case DISPLAYTEXT_MASK_BMPSTRING:

            pThisObject = AnscAsn1CreateBMPString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case DISPLAYTEXT_MASK_UTF8STRING:

            pThisObject = AnscAsn1CreateUTF8String(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case DISPLAYTEXT_MASK_IA5STRING:

            pThisObject = AnscAsn1CreateIA5String(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;
    }

    return pThisObject;

}

PCHAR
AnscAsn1DisplayTextGetSelectionName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( selType )
    {
        case DISPLAYTEXT_MASK_VISIBLESTRING:

            return"visibleString";

        case DISPLAYTEXT_MASK_BMPSTRING:

            return"bmpString";

        case DISPLAYTEXT_MASK_UTF8STRING:

            return"utf8String";

        case DISPLAYTEXT_MASK_IA5STRING:

            return"ia5String";
    }
   
    return "";

}

PANSC_ATTR_OBJECT
AnscAsn1DisplayTextCreateSelectionAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    switch ( selType )
    {
        case DISPLAYTEXT_MASK_VISIBLESTRING:

                break;

        case DISPLAYTEXT_MASK_BMPSTRING:

                break;

        case DISPLAYTEXT_MASK_UTF8STRING:

                break;

        case DISPLAYTEXT_MASK_IA5STRING:

                break;
    }

    return pAttrObject;

}

BOOLEAN
AnscAsn1DisplayTextGetChoiceTagValue
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       uIndex,
        PASN_OBJECT_FORM_TYPE       pAttr,
        PULONG                      pTagValue
    )
{
   UNREFERENCED_PARAMETER(hThisObject);
   if( pAttr == NULL || pTagValue == NULL)
    {
        return FALSE;
    }

    switch ( uIndex )
    {
        case DISPLAYTEXT_MASK_VISIBLESTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = ASN1_VISIBLESTRING_TYPE;

            return TRUE;

        case DISPLAYTEXT_MASK_BMPSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = ASN1_BMPSTRING_TYPE;

            return TRUE;

        case DISPLAYTEXT_MASK_UTF8STRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = ASN1_UTF8STRING_TYPE;

            return TRUE;

        case DISPLAYTEXT_MASK_IA5STRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = ASN1_IA5STRING_TYPE;

            return TRUE;
    }

    return FALSE;

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_POLICYMAPPINGS

 PolicyMappings ::= SequenceOf PolicyMapping  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreatePolicyMappings
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_POLICYMAPPINGS       pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_POLICYMAPPINGS)
        AnscAsn1CreateSequenceOf
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_POLICYMAPPINGS");
    pThisObject->SetName(pThisObject, "PolicyMappings");

    pThisObject->Create             = AnscAsn1CreatePolicyMappings;
    pThisObject->CreateChild        = AnscAsn1PolicyMappingsCreateChild;
    pThisObject->IsChildValid       = AnscAsn1PolicyMappingsIsChildValid;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1PolicyMappingsCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreatePolicyMapping(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1PolicyMappingsIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_POLICYMAPPING", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_NAMECONSTRAINTS

 NameConstraints ::= Sequence 
     {
                 permittedSubtrees [CON 0] IMP GeneralSubtrees OPT
                  excludedSubtrees [CON 1] IMP GeneralSubtrees OPT
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateNameConstraints
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_NAMECONSTRAINTS      pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_NAMECONSTRAINTS)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_NAMECONSTRAINTS)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_NAMECONSTRAINTS");
    pThisObject->SetName(pThisObject, "NameConstraints");

    pThisObject->Create             = AnscAsn1CreateNameConstraints;
    pThisObject->CreateChildAttr    = AnscAsn1NameConstraintsCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1NameConstraintsGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1NameConstraintsCreateChildObject;
    pThisObject->uTotalChild        = 2;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1NameConstraintsCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateGeneralSubtrees(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateGeneralSubtrees(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1NameConstraintsCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    switch ( index )
    {
        case 0:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          0,
                          IMPLICIT_TYPE
                        );

                break;

        case 1:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          1,
                          IMPLICIT_TYPE
                        );

                break;

    }

    return pAttrObject;

}

PCHAR
AnscAsn1NameConstraintsGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( index )
    {
        case 0:

            return"permittedSubtrees";

        case 1:

            return"excludedSubtrees";

    }

    return "";

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_GENERALSUBTREES

 GeneralSubtrees ::= SequenceOf GeneralSubTree  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateGeneralSubtrees
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_GENERALSUBTREES      pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_GENERALSUBTREES)
        AnscAsn1CreateSequenceOf
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_GENERALSUBTREES");
    pThisObject->SetName(pThisObject, "GeneralSubtrees");

    pThisObject->Create             = AnscAsn1CreateGeneralSubtrees;
    pThisObject->CreateChild        = AnscAsn1GeneralSubtreesCreateChild;
    pThisObject->IsChildValid       = AnscAsn1GeneralSubtreesIsChildValid;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1GeneralSubtreesCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreateGeneralSubTree(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1GeneralSubtreesIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_GENERALSUBTREE", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_GENERALSUBTREE

 GeneralSubTree ::= Sequence 
     {
                              base GeneralName 
                           minimum [CON 0] IMP Integer DEF
                           maximum [CON 1] IMP Integer OPT
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateGeneralSubTree
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_GENERALSUBTREE       pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_GENERALSUBTREE)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_GENERALSUBTREE)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_GENERALSUBTREE");
    pThisObject->SetName(pThisObject, "GeneralSubTree");

    pThisObject->Create             = AnscAsn1CreateGeneralSubTree;
    pThisObject->CreateChildAttr    = AnscAsn1GeneralSubTreeCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1GeneralSubTreeGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1GeneralSubTreeCreateChildObject;
    pThisObject->uTotalChild        = 3;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1GeneralSubTreeCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateGeneralName(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateInteger(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 2:

            pThisObject = AnscAsn1CreateInteger(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1GeneralSubTreeCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    switch ( index )
    {
        case 0:

                break;

        case 1:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          0,
                          IMPLICIT_TYPE
                        );

                break;

        case 2:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          1,
                          IMPLICIT_TYPE
                        );

                break;

    }

    return pAttrObject;

}

PCHAR
AnscAsn1GeneralSubTreeGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( index )
    {
        case 0:

            return"base";

        case 1:

            return"minimum";

        case 2:

            return"maximum";

    }

    return "";

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_POLICYCONSTRAINTS

 PolicyConstraints ::= Sequence 
     {
             requireExplicitPolicy [CON 0] IMP Integer OPT
              inhibitPolicyMapping [CON 1] IMP Integer OPT
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreatePolicyConstraints
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_POLICYCONSTRAINTS    pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_POLICYCONSTRAINTS)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_POLICYCONSTRAINTS)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_POLICYCONSTRAINTS");
    pThisObject->SetName(pThisObject, "PolicyConstraints");

    pThisObject->Create             = AnscAsn1CreatePolicyConstraints;
    pThisObject->CreateChildAttr    = AnscAsn1PolicyConstraintsCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1PolicyConstraintsGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1PolicyConstraintsCreateChildObject;
    pThisObject->uTotalChild        = 2;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1PolicyConstraintsCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateInteger(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateInteger(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1PolicyConstraintsCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    switch ( index )
    {
        case 0:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          0,
                          IMPLICIT_TYPE
                        );

                break;

        case 1:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          1,
                          IMPLICIT_TYPE
                        );

                break;

    }

    return pAttrObject;

}

PCHAR
AnscAsn1PolicyConstraintsGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
   
    if( hThisObject == NULL)
    {
        return NULL;
    }

    switch ( index )
    {
        case 0:

            return"requireExplicitPolicy";

        case 1:

            return"inhibitPolicyMapping";

    }

    return "";

}


/**********************************************************************

 OBJECT -- ANSC_ASN1_SUBJECTDIRECTORYATTRIBUTES

 SubjectDirectoryAttributes ::= SequenceOf Attribute  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateSubjectDirectoryAttributes
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_SUBJECTDIRECTORYATTRIBUTES 
                                    pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_SUBJECTDIRECTORYATTRIBUTES)
        AnscAsn1CreateSequenceOf
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_SUBJECTDIRECTORYATTRIBUTES");
    pThisObject->SetName(pThisObject, "SubjectDirectoryAttributes");

    pThisObject->Create             = AnscAsn1CreateSubjectDirectoryAttributes;
    pThisObject->CreateChild        = AnscAsn1SubjectDirectoryAttributesCreateChild;
    pThisObject->IsChildValid       = AnscAsn1SubjectDirectoryAttributesIsChildValid;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1SubjectDirectoryAttributesCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreateAttribute(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1SubjectDirectoryAttributesIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_ATTRIBUTE", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_CRLNUMBER

 CRLNumber ::= Integer 

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateCRLNumber
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_CRLNUMBER            pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_CRLNUMBER)
        AnscAsn1CreateInteger
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_CRLNUMBER");
    pThisObject->SetName(pThisObject, "CRLNumber");

    pThisObject->Create             = AnscAsn1CreateCRLNumber;

    return (ANSC_HANDLE)pThisObject;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_CRLDISTPOINTSSYNTAX

 CRLDistPointsSyntax ::= SequenceOf DistributionPoint  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateCRLDistPointsSyntax
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_CRLDISTPOINTSSYNTAX  pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_CRLDISTPOINTSSYNTAX)
        AnscAsn1CreateSequenceOf
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_CRLDISTPOINTSSYNTAX");
    pThisObject->SetName(pThisObject, "CRLDistPointsSyntax");

    pThisObject->Create             = AnscAsn1CreateCRLDistPointsSyntax;
    pThisObject->CreateChild        = AnscAsn1CRLDistPointsSyntaxCreateChild;
    pThisObject->IsChildValid       = AnscAsn1CRLDistPointsSyntaxIsChildValid;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1CRLDistPointsSyntaxCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreateDistributionPoint(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1CRLDistPointsSyntaxIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_DISTRIBUTIONPOINT", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_DISTRIBUTIONPOINT

 DistributionPoint ::= Sequence 
     {
                 distributionPoint [CON 0] IMP DistributionPointName OPT
                           reasons [CON 1] IMP ReasonFlags OPT
                         cRLIssuer [CON 2] IMP GeneralNames OPT
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateDistributionPoint
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_DISTRIBUTIONPOINT    pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_DISTRIBUTIONPOINT)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_DISTRIBUTIONPOINT)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_DISTRIBUTIONPOINT");
    pThisObject->SetName(pThisObject, "DistributionPoint");

    pThisObject->Create             = AnscAsn1CreateDistributionPoint;
    pThisObject->CreateChildAttr    = AnscAsn1DistributionPointCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1DistributionPointGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1DistributionPointCreateChildObject;
    pThisObject->uTotalChild        = 3;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1DistributionPointCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateDistributionPointName(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateReasonFlags(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 2:

            pThisObject = AnscAsn1CreateGeneralNames(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1DistributionPointCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    switch ( index )
    {
        case 0:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          0,
                          IMPLICIT_TYPE
                        );

                break;

        case 1:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          1,
                          IMPLICIT_TYPE
                        );

                break;

        case 2:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          2,
                          IMPLICIT_TYPE
                        );

                break;

    }

    return pAttrObject;

}

PCHAR
AnscAsn1DistributionPointGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( index )
    {
        case 0:

            return"distributionPoint";

        case 1:

            return"reasons";

        case 2:

            return"cRLIssuer";

    }

    return "";

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_DISTRIBUTIONPOINTNAME

 DistributionPointName ::= Choice 
     {
                          fullName [CON 0] IMP GeneralNames 
           nameRelativeToCRLIssuer [CON 1] IMP RelativeDistinguishedName 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateDistributionPointName
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_DISTRIBUTIONPOINTNAME 
                                    pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_DISTRIBUTIONPOINTNAME)
        AnscAsn1CreateChoice
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_DISTRIBUTIONPOINTNAME");
    pThisObject->SetName(pThisObject, "DistributionPointName");

    pThisObject->Create             = AnscAsn1CreateDistributionPointName;
    pThisObject->CreateSelection    = AnscAsn1DistributionPointNameCreateSelection;
    pThisObject->GetSelectionName   = AnscAsn1DistributionPointNameGetSelectionName;
    pThisObject->CreateSelectionAttr= AnscAsn1DistributionPointNameCreateSelectionAttr;
    pThisObject->GetChoiceTagValue  = AnscAsn1DistributionPointNameGetChoiceTagValue;
    pThisObject->uTotalChoice       = DISTRIBUTIONPOINTNAME_MAXI_MASK + 1;
    pThisObject->bChoiceByOID       = FALSE;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1DistributionPointNameCreateSelection
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_CHOICE               pParent         = (PANSC_ASN1_CHOICE)hThisObject;

    switch( index )
    {

        case DISTRIBUTIONPOINTNAME_MASK_FULLNAME:

            pThisObject = AnscAsn1CreateGeneralNames(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case DISTRIBUTIONPOINTNAME_MASK_NAMERELATIVETOCRLISSUER:

            pThisObject = AnscAsn1CreateRelativeDistinguishedName(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PCHAR
AnscAsn1DistributionPointNameGetSelectionName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( selType )
    {
        case DISTRIBUTIONPOINTNAME_MASK_FULLNAME:

            return"fullName";

        case DISTRIBUTIONPOINTNAME_MASK_NAMERELATIVETOCRLISSUER:

            return"nameRelativeToCRLIssuer";

    }

    return "";

}

PANSC_ATTR_OBJECT
AnscAsn1DistributionPointNameCreateSelectionAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    switch ( selType )
    {
        case DISTRIBUTIONPOINTNAME_MASK_FULLNAME:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          0,
                          IMPLICIT_TYPE
                        );

                break;

        case DISTRIBUTIONPOINTNAME_MASK_NAMERELATIVETOCRLISSUER:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          1,
                          IMPLICIT_TYPE
                        );

                break;

    }

    return pAttrObject;

}

BOOLEAN
AnscAsn1DistributionPointNameGetChoiceTagValue
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       uIndex,
        PASN_OBJECT_FORM_TYPE       pAttr,
        PULONG                      pTagValue
    )
{
   UNREFERENCED_PARAMETER(hThisObject);
   if( pAttr == NULL || pTagValue == NULL)
    {
        return FALSE;
    }

    switch ( uIndex )
    {
        case DISTRIBUTIONPOINTNAME_MASK_FULLNAME:

            *pAttr       = CONTEXT_FORM;
            *pTagValue   = 0;

            return TRUE;

        case DISTRIBUTIONPOINTNAME_MASK_NAMERELATIVETOCRLISSUER:

            *pAttr       = CONTEXT_FORM;
            *pTagValue   = 1;

            return TRUE;

    }

    return FALSE;

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_REASONFLAGS

 ReasonFlags ::= BitString 

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateReasonFlags
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_REASONFLAGS          pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_REASONFLAGS)
        AnscAsn1CreateBitString
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_REASONFLAGS");
    pThisObject->SetName(pThisObject, "ReasonFlags");

    pThisObject->Create             = AnscAsn1CreateReasonFlags;

    return (ANSC_HANDLE)pThisObject;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_ISSUINGDISTRIBUTIONPOINT

 IssuingDistributionPoint ::= Sequence 
     {
                 distributionPoint [CON 0] IMP DistributionPointName OPT
           onlyConstrainsUserCerts [CON 1] IMP BOOL DEF
             onlyConstrainsCACerts [CON 2] IMP BOOL DEF
                   onlySomeReasons [CON 3] IMP ReasonFlags OPT
                       indirectCRL [CON 4] IMP BOOL DEF
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateIssuingDistributionPoint
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_ISSUINGDISTRIBUTIONPOINT 
                                    pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_ISSUINGDISTRIBUTIONPOINT)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_ISSUINGDISTRIBUTIONPOINT)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_ISSUINGDISTRIBUTIONPOINT");
    pThisObject->SetName(pThisObject, "IssuingDistributionPoint");

    pThisObject->Create             = AnscAsn1CreateIssuingDistributionPoint;
    pThisObject->CreateChildAttr    = AnscAsn1IssuingDistributionPointCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1IssuingDistributionPointGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1IssuingDistributionPointCreateChildObject;
    pThisObject->uTotalChild        = 5;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1IssuingDistributionPointCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateDistributionPointName(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateBOOL(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 2:

            pThisObject = AnscAsn1CreateBOOL(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 3:

            pThisObject = AnscAsn1CreateReasonFlags(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

        case 4:

            pThisObject = AnscAsn1CreateBOOL(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1IssuingDistributionPointCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    switch ( index )
    {
        case 0:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          0,
                          IMPLICIT_TYPE
                        );

                break;

        case 1:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          1,
                          IMPLICIT_TYPE
                        );

                break;

        case 2:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          2,
                          IMPLICIT_TYPE
                        );

                break;

        case 3:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          3,
                          IMPLICIT_TYPE
                        );

                break;

        case 4:

                pAttrObject = (PANSC_ATTR_OBJECT)
                    AnscAsn1AttrCreate
                        (
                          CONTEXT_FORM,
                          4,
                          IMPLICIT_TYPE
                        );

                break;

    }

    return pAttrObject;

}

PCHAR
AnscAsn1IssuingDistributionPointGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( index )
    {
        case 0:

            return"distributionPoint";

        case 1:

            return"onlyConstrainsUserCerts";

        case 2:

            return"onlyConstrainsCACerts";

        case 3:

            return"onlySomeReasons";

        case 4:

            return"indirectCRL";

    }

    return "";

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_AUTHORITYINFOACCESSSYNTAX

 AuthorityInfoAccessSyntax ::= SequenceOf AccessDescription  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateAuthorityInfoAccessSyntax
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_AUTHORITYINFOACCESSSYNTAX 
                                    pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_AUTHORITYINFOACCESSSYNTAX)
        AnscAsn1CreateSequenceOf
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_AUTHORITYINFOACCESSSYNTAX");
    pThisObject->SetName(pThisObject, "AuthorityInfoAccessSyntax");

    pThisObject->Create             = AnscAsn1CreateAuthorityInfoAccessSyntax;
    pThisObject->CreateChild        = AnscAsn1AuthorityInfoAccessSyntaxCreateChild;
    pThisObject->IsChildValid       = AnscAsn1AuthorityInfoAccessSyntaxIsChildValid;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1AuthorityInfoAccessSyntaxCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreateAccessDescription(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1AuthorityInfoAccessSyntaxIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_ACCESSDESCRIPTION", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_ACCESSDESCRIPTION

 AccessDescription ::= Sequence 
     {
                      accessMethod OID 
                    accessLocation GeneralName 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateAccessDescription
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_ACCESSDESCRIPTION    pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_ACCESSDESCRIPTION)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_ACCESSDESCRIPTION)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_ACCESSDESCRIPTION");
    pThisObject->SetName(pThisObject, "AccessDescription");

    pThisObject->Create             = AnscAsn1CreateAccessDescription;
    pThisObject->CreateChildAttr    = AnscAsn1AccessDescriptionCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1AccessDescriptionGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1AccessDescriptionCreateChildObject;
    pThisObject->uTotalChild        = 2;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1AccessDescriptionCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateOID(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateGeneralName(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1AccessDescriptionCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(index);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

PCHAR
AnscAsn1AccessDescriptionGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);   
    switch ( index )
    {
        case 0:

            return"accessMethod";

        case 1:

            return"accessLocation";

    }

    return "";

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_CRLREASON

 CRLReason ::= Enumerate 

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateCRLReason
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_CRLREASON            pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_CRLREASON)
        AnscAsn1CreateEnumerate
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_CRLREASON");
    pThisObject->SetName(pThisObject, "CRLReason");

    pThisObject->Create             = AnscAsn1CreateCRLReason;

    return (ANSC_HANDLE)pThisObject;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_HOLDINSTRUCTIONCODE

 HoldInstructionCode ::= OID 

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateHoldInstructionCode
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_HOLDINSTRUCTIONCODE  pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_HOLDINSTRUCTIONCODE)
        AnscAsn1CreateOID
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_HOLDINSTRUCTIONCODE");
    pThisObject->SetName(pThisObject, "HoldInstructionCode");

    pThisObject->Create             = AnscAsn1CreateHoldInstructionCode;

    return (ANSC_HANDLE)pThisObject;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_INVALIDITYDATE

 InvalidityDate ::= Time 

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateInvalidityDate
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_INVALIDITYDATE       pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_INVALIDITYDATE)
        AnscAsn1CreateTime
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_INVALIDITYDATE");
    pThisObject->SetName(pThisObject, "InvalidityDate");

    pThisObject->Create             = AnscAsn1CreateInvalidityDate;

    return (ANSC_HANDLE)pThisObject;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_POLICYMAPPING

 PolicyMapping ::= Sequence 
     {
              issuerDomainPolicyID OID 
             subjectDomainPolicyID OID 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreatePolicyMapping
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_POLICYMAPPING        pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_POLICYMAPPING)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_POLICYMAPPING)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_POLICYMAPPING");
    pThisObject->SetName(pThisObject, "PolicyMapping");

    pThisObject->Create             = AnscAsn1CreatePolicyMapping;
    pThisObject->CreateChildAttr    = AnscAsn1PolicyMappingCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1PolicyMappingGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1PolicyMappingCreateChildObject;
    pThisObject->uTotalChild        = 2;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1PolicyMappingCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateOID(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateOID(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1PolicyMappingCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(index);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

PCHAR
AnscAsn1PolicyMappingGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);  
    switch ( index )
    {
        case 0:

            return"issuerDomainPolicyID";

        case 1:

            return"subjectDomainPolicyID";

    }

    return "";

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_NOTICENUMBERS

 NoticeNumbers ::= SequenceOf Integer  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateNoticeNumbers
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_NOTICENUMBERS        pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_NOTICENUMBERS)
        AnscAsn1CreateSequenceOf
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_NOTICENUMBERS");
    pThisObject->SetName(pThisObject, "NoticeNumbers");

    pThisObject->Create             = AnscAsn1CreateNoticeNumbers;
    pThisObject->CreateChild        = AnscAsn1NoticeNumbersCreateChild;
    pThisObject->IsChildValid       = AnscAsn1NoticeNumbersIsChildValid;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1NoticeNumbersCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreateInteger(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1NoticeNumbersIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_INTEGER", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    if( pChild->uType != 0x02)
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_DELTACRLINDICATOR

 DeltaCRLIndicator ::= CRLNumber 

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateDeltaCRLIndicator
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_DELTACRLINDICATOR    pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_DELTACRLINDICATOR)
        AnscAsn1CreateCRLNumber
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_DELTACRLINDICATOR");
    pThisObject->SetName(pThisObject, "DeltaCRLIndicator");

    pThisObject->Create             = AnscAsn1CreateDeltaCRLIndicator;

    return (ANSC_HANDLE)pThisObject;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_ATTRIBUTESSYNTAX

 AttributesSyntax ::= SequenceOf Attribute  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateAttributesSyntax
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_ATTRIBUTESSYNTAX     pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_ATTRIBUTESSYNTAX)
        AnscAsn1CreateSequenceOf
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_ATTRIBUTESSYNTAX");
    pThisObject->SetName(pThisObject, "AttributesSyntax");

    pThisObject->Create             = AnscAsn1CreateAttributesSyntax;
    pThisObject->CreateChild        = AnscAsn1AttributesSyntaxCreateChild;
    pThisObject->IsChildValid       = AnscAsn1AttributesSyntaxIsChildValid;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1AttributesSyntaxCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreateAttribute(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1AttributesSyntaxIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_ATTRIBUTE", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_BIOMETRICSSYNTAX

 BiometricsSyntax ::= SequenceOf BiometricData  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateBiometricsSyntax
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_BIOMETRICSSYNTAX     pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_BIOMETRICSSYNTAX)
        AnscAsn1CreateSequenceOf
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_BIOMETRICSSYNTAX");
    pThisObject->SetName(pThisObject, "BiometricsSyntax");

    pThisObject->Create             = AnscAsn1CreateBiometricsSyntax;
    pThisObject->CreateChild        = AnscAsn1BiometricsSyntaxCreateChild;
    pThisObject->IsChildValid       = AnscAsn1BiometricsSyntaxIsChildValid;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1BiometricsSyntaxCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreateBiometricData(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1BiometricsSyntaxIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_BIOMETRICDATA", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_BIOMETRICDATA

 BiometricData ::= Sequence 
     {
               typeOfBiometricData TypeOfBiometricData 
                     hashAlgorithm AlgorithmIdentifier 
                 biometricDataHash OctetString 
                     sourceDataUri IA5String 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateBiometricData
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_BIOMETRICDATA        pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_BIOMETRICDATA)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_BIOMETRICDATA)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_BIOMETRICDATA");
    pThisObject->SetName(pThisObject, "BiometricData");

    pThisObject->Create             = AnscAsn1CreateBiometricData;
    pThisObject->CreateChildAttr    = AnscAsn1BiometricDataCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1BiometricDataGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1BiometricDataCreateChildObject;
    pThisObject->uTotalChild        = 4;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1BiometricDataCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateTypeOfBiometricData(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateAlgorithmIdentifier(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

        case 2:

            pThisObject = AnscAsn1CreateOctetString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

        case 3:

            pThisObject = AnscAsn1CreateIA5String(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1BiometricDataCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(index);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

PCHAR
AnscAsn1BiometricDataGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( index )
    {
        case 0:

            return"typeOfBiometricData";

        case 1:

            return"hashAlgorithm";

        case 2:

            return"biometricDataHash";

        case 3:

            return"sourceDataUri";

    }

    return "";

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_TYPEOFBIOMETRICDATA

 TypeOfBiometricData ::= Choice 
     {
                    predefinedType Integer 
                  biometricDataOID OID 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateTypeOfBiometricData
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_TYPEOFBIOMETRICDATA  pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_TYPEOFBIOMETRICDATA)
        AnscAsn1CreateChoice
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_TYPEOFBIOMETRICDATA");
    pThisObject->SetName(pThisObject, "TypeOfBiometricData");

    pThisObject->Create             = AnscAsn1CreateTypeOfBiometricData;
    pThisObject->CreateSelection    = AnscAsn1TypeOfBiometricDataCreateSelection;
    pThisObject->GetSelectionName   = AnscAsn1TypeOfBiometricDataGetSelectionName;
    pThisObject->CreateSelectionAttr= AnscAsn1TypeOfBiometricDataCreateSelectionAttr;
    pThisObject->GetChoiceTagValue  = AnscAsn1TypeOfBiometricDataGetChoiceTagValue;
    pThisObject->uTotalChoice       = TYPEOFBIOMETRICDATA_MAXI_MASK + 1;
    pThisObject->bChoiceByOID       = FALSE;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1TypeOfBiometricDataCreateSelection
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_CHOICE               pParent         = (PANSC_ASN1_CHOICE)hThisObject;

    switch( index )
    {

        case TYPEOFBIOMETRICDATA_MASK_PREDEFINEDTYPE:

            pThisObject = AnscAsn1CreateInteger(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case TYPEOFBIOMETRICDATA_MASK_BIOMETRICDATAOID:

            pThisObject = AnscAsn1CreateOID(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PCHAR
AnscAsn1TypeOfBiometricDataGetSelectionName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( selType )
    {
        case TYPEOFBIOMETRICDATA_MASK_PREDEFINEDTYPE:

            return"predefinedType";

        case TYPEOFBIOMETRICDATA_MASK_BIOMETRICDATAOID:

            return"biometricDataOID";

    }

    return "";

}

PANSC_ATTR_OBJECT
AnscAsn1TypeOfBiometricDataCreateSelectionAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(selType);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

BOOLEAN
AnscAsn1TypeOfBiometricDataGetChoiceTagValue
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       uIndex,
        PASN_OBJECT_FORM_TYPE       pAttr,
        PULONG                      pTagValue
    )
{
   UNREFERENCED_PARAMETER(hThisObject);
   if( pAttr == NULL || pTagValue == NULL)
    {
        return FALSE;
    }

    switch ( uIndex )
    {
        case TYPEOFBIOMETRICDATA_MASK_PREDEFINEDTYPE:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x02;

            return TRUE;

        case TYPEOFBIOMETRICDATA_MASK_BIOMETRICDATAOID:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x06;

            return TRUE;

    }

    return FALSE;

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_QCSTATEMENTSSYNTAX

 QCStatementsSyntax ::= SequenceOf QCStatement  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateQCStatementsSyntax
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_QCSTATEMENTSSYNTAX   pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_QCSTATEMENTSSYNTAX)
        AnscAsn1CreateSequenceOf
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_QCSTATEMENTSSYNTAX");
    pThisObject->SetName(pThisObject, "QCStatementsSyntax");

    pThisObject->Create             = AnscAsn1CreateQCStatementsSyntax;
    pThisObject->CreateChild        = AnscAsn1QCStatementsSyntaxCreateChild;
    pThisObject->IsChildValid       = AnscAsn1QCStatementsSyntaxIsChildValid;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1QCStatementsSyntaxCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreateQCStatement(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1QCStatementsSyntaxIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_QCSTATEMENT", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_QCSTATEMENT

 QCStatement ::= Sequence 
     {
                      statementOID OID 
                     statementInfo OctetString 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateQCStatement
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_QCSTATEMENT          pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_QCSTATEMENT)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_QCSTATEMENT)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_QCSTATEMENT");
    pThisObject->SetName(pThisObject, "QCStatement");

    pThisObject->Create             = AnscAsn1CreateQCStatement;
    pThisObject->CreateChildAttr    = AnscAsn1QCStatementCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1QCStatementGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1QCStatementCreateChildObject;
    pThisObject->uTotalChild        = 2;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1QCStatementCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateOID(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateOctetString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
                pThisObject->bCanBeOptional = TRUE;
                pThisObject->bOptional = TRUE;
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1QCStatementCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(index);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

PCHAR
AnscAsn1QCStatementGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);   
    switch ( index )
    {
        case 0:

            return"statementOID";

        case 1:

            return"statementInfo";

    }

    return "";

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_ENTRUSTVERSIONINFO

 EntrustVersionInfo ::= Sequence 
     {
                           version GeneralString 
                             usage BitString 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateEntrustVersionInfo
    (
        ANSC_HANDLE                 hReserved
    )
{
    UNREFERENCED_PARAMETER(hReserved);
    PANSC_ASN1_ENTRUSTVERSIONINFO   pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_ENTRUSTVERSIONINFO)
        AnscAsn1CreateSequence
            (
                (ANSC_HANDLE)sizeof(ANSC_ASN1_ENTRUSTVERSIONINFO)
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_ENTRUSTVERSIONINFO");
    pThisObject->SetName(pThisObject, "EntrustVersionInfo");

    pThisObject->Create             = AnscAsn1CreateEntrustVersionInfo;
    pThisObject->CreateChildAttr    = AnscAsn1EntrustVersionInfoCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1EntrustVersionInfoGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1EntrustVersionInfoCreateChildObject;
    pThisObject->uTotalChild        = 2;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1EntrustVersionInfoCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateGeneralString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateBitString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1EntrustVersionInfoCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(index);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

PCHAR
AnscAsn1EntrustVersionInfoGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{

    UNREFERENCED_PARAMETER(hThisObject);   
    switch ( index )
    {
        case 0:

            return"version";

        case 1:

            return"usage";

    }

    return "";

}


/**********************************************************************

 OBJECT -- ANSC_ASN1_EXTENSIONVALUE

 ExtensionValue ::= Choice 
     {
            authorityKeyIdentifier AuthorityKeyIdentifier 
                          keyUsage KeyUsage 
             privateKeyUsagePeriod PrivateKeyUsagePeriod 
                      certPolicies CertificatePolicies 
                    policyMappings PolicyMappings 
            subDirectoryAttributes SubjectDirectoryAttributes 
                  basicConstraints BasicConstraints 
                   nameConstraints NameConstraints 
                 policyConstraints PolicyConstraints 
               crlDistPointsSyntax CRLDistPointsSyntax 
                 extKeyUsageSyntax ExtKeyUsageSyntax 
              authInfoAccessSyntax AuthorityInfoAccessSyntax 
                         crlNumber CRLNumber 
          issuingDistributionPoint IssuingDistributionPoint 
                         crlReason CRLReason 
               holdInstructionCode HoldInstructionCode 
                    invalidityDate InvalidityDate 
                      isserAltName GeneralNames 
                    subjectAltName GeneralNames 
                 deltaCRLIndicator CRLNumber 
                 certificateIssuer GeneralNames 
              subjectKeyIdentifier OctetString 
                  biometricsSyntax BiometricsSyntax 
                qcStatementsSyntax QCStatementsSyntax 
                  netscapeCertType BitString 
                   netscapeComment IA5String 
                        commonName DirectoryString 
                entrustVersionInfo EntrustVersionInfo 
                caKeyCertIndexPair Integer 
                          msString MSString 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateExtensionValue
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_EXTENSIONVALUE       pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_EXTENSIONVALUE)
        AnscAsn1CreateChoice
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_EXTENSIONVALUE");
    pThisObject->SetName(pThisObject, "ExtensionValue");

    pThisObject->Create             = AnscAsn1CreateExtensionValue;
    pThisObject->CreateSelection    = AnscAsn1ExtensionValueCreateSelection;
    pThisObject->GetSelectionName   = AnscAsn1ExtensionValueGetSelectionName;
    pThisObject->CreateSelectionAttr= AnscAsn1ExtensionValueCreateSelectionAttr;
    pThisObject->GetChoiceFromOID   = AnscAsn1ExtensionValueGetChoiceByOID;
    pThisObject->GetOIDValueByMask  = AnscAsn1ExtensionValueGetOIDValueByMask;
    pThisObject->uTotalChoice       = EXTENSIONVALUE_MAXI_MASK + 1;
    pThisObject->bChoiceByOID       = TRUE;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1ExtensionValueCreateSelection
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_CHOICE               pParent         = (PANSC_ASN1_CHOICE)hThisObject;

    switch( index )
    {

        case EXTENSIONVALUE_MASK_AUTHORITYKEYIDENTIFIER:

            pThisObject = AnscAsn1CreateAuthorityKeyIdentifier(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_KEYUSAGE:

            pThisObject = AnscAsn1CreateKeyUsage(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_PRIVATEKEYUSAGEPERIOD:

            pThisObject = AnscAsn1CreatePrivateKeyUsagePeriod(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_CERTPOLICIES:

            pThisObject = AnscAsn1CreateCertificatePolicies(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_POLICYMAPPINGS:

            pThisObject = AnscAsn1CreatePolicyMappings(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_SUBDIRECTORYATTRIBUTES:

            pThisObject = AnscAsn1CreateSubjectDirectoryAttributes(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_BASICCONSTRAINTS:

            pThisObject = AnscAsn1CreateBasicConstraints(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_NAMECONSTRAINTS:

            pThisObject = AnscAsn1CreateNameConstraints(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_POLICYCONSTRAINTS:

            pThisObject = AnscAsn1CreatePolicyConstraints(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_CRLDISTPOINTSSYNTAX:

            pThisObject = AnscAsn1CreateCRLDistPointsSyntax(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_EXTKEYUSAGESYNTAX:

            pThisObject = AnscAsn1CreateExtKeyUsageSyntax(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_AUTHINFOACCESSSYNTAX:

            pThisObject = AnscAsn1CreateAuthorityInfoAccessSyntax(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_CRLNUMBER:

            pThisObject = AnscAsn1CreateCRLNumber(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_ISSUINGDISTRIBUTIONPOINT:

            pThisObject = AnscAsn1CreateIssuingDistributionPoint(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_CRLREASON:

            pThisObject = AnscAsn1CreateCRLReason(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_HOLDINSTRUCTIONCODE:

            pThisObject = AnscAsn1CreateHoldInstructionCode(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_INVALIDITYDATE:

            pThisObject = AnscAsn1CreateInvalidityDate(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_ISSERALTNAME:

            pThisObject = AnscAsn1CreateGeneralNames(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_SUBJECTALTNAME:

            pThisObject = AnscAsn1CreateGeneralNames(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_DELTACRLINDICATOR:

            pThisObject = AnscAsn1CreateCRLNumber(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_CERTIFICATEISSUER:

            pThisObject = AnscAsn1CreateGeneralNames(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_SUBJECTKEYIDENTIFIER:

            pThisObject = AnscAsn1CreateOctetString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_BIOMETRICSSYNTAX:

            pThisObject = AnscAsn1CreateBiometricsSyntax(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_QCSTATEMENTSSYNTAX:

            pThisObject = AnscAsn1CreateQCStatementsSyntax(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_NETSCAPECERTTYPE:

            pThisObject = AnscAsn1CreateBitString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_NETSCAPECOMMENT:

            pThisObject = AnscAsn1CreateIA5String(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_COMMONNAME:

            pThisObject = AnscAsn1CreateDirectoryString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_ENTRUSTVERSIONINFO:

            pThisObject = AnscAsn1CreateEntrustVersionInfo(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_CAKEYCERTINDEXPAIR:

            pThisObject = AnscAsn1CreateInteger(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case EXTENSIONVALUE_MASK_MSSTRING:

            pThisObject = AnscAsn1CreateMSString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PCHAR
AnscAsn1ExtensionValueGetSelectionName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);   
    switch ( selType )
    {
        case EXTENSIONVALUE_MASK_AUTHORITYKEYIDENTIFIER:

            return"authorityKeyIdentifier";

        case EXTENSIONVALUE_MASK_KEYUSAGE:

            return"keyUsage";

        case EXTENSIONVALUE_MASK_PRIVATEKEYUSAGEPERIOD:

            return"privateKeyUsagePeriod";

        case EXTENSIONVALUE_MASK_CERTPOLICIES:

            return"certPolicies";

        case EXTENSIONVALUE_MASK_POLICYMAPPINGS:

            return"policyMappings";

        case EXTENSIONVALUE_MASK_SUBDIRECTORYATTRIBUTES:

            return"subDirectoryAttributes";

        case EXTENSIONVALUE_MASK_BASICCONSTRAINTS:

            return"basicConstraints";

        case EXTENSIONVALUE_MASK_NAMECONSTRAINTS:

            return"nameConstraints";

        case EXTENSIONVALUE_MASK_POLICYCONSTRAINTS:

            return"policyConstraints";

        case EXTENSIONVALUE_MASK_CRLDISTPOINTSSYNTAX:

            return"crlDistPointsSyntax";

        case EXTENSIONVALUE_MASK_EXTKEYUSAGESYNTAX:

            return"extKeyUsageSyntax";

        case EXTENSIONVALUE_MASK_AUTHINFOACCESSSYNTAX:

            return"authInfoAccessSyntax";

        case EXTENSIONVALUE_MASK_CRLNUMBER:

            return"crlNumber";

        case EXTENSIONVALUE_MASK_ISSUINGDISTRIBUTIONPOINT:

            return"issuingDistributionPoint";

        case EXTENSIONVALUE_MASK_CRLREASON:

            return"crlReason";

        case EXTENSIONVALUE_MASK_HOLDINSTRUCTIONCODE:

            return"holdInstructionCode";

        case EXTENSIONVALUE_MASK_INVALIDITYDATE:

            return"invalidityDate";

        case EXTENSIONVALUE_MASK_ISSERALTNAME:

            return"isserAltName";

        case EXTENSIONVALUE_MASK_SUBJECTALTNAME:

            return"subjectAltName";

        case EXTENSIONVALUE_MASK_DELTACRLINDICATOR:

            return"deltaCRLIndicator";

        case EXTENSIONVALUE_MASK_CERTIFICATEISSUER:

            return"certificateIssuer";

        case EXTENSIONVALUE_MASK_SUBJECTKEYIDENTIFIER:

            return"subjectKeyIdentifier";

        case EXTENSIONVALUE_MASK_BIOMETRICSSYNTAX:

            return"biometricsSyntax";

        case EXTENSIONVALUE_MASK_QCSTATEMENTSSYNTAX:

            return"qcStatementsSyntax";

        case EXTENSIONVALUE_MASK_NETSCAPECERTTYPE:

            return"netscapeCertType";

        case EXTENSIONVALUE_MASK_NETSCAPECOMMENT:

            return"netscapeComment";

        case EXTENSIONVALUE_MASK_COMMONNAME:

            return"commonName";

        case EXTENSIONVALUE_MASK_ENTRUSTVERSIONINFO:

            return"entrustVersionInfo";

        case EXTENSIONVALUE_MASK_CAKEYCERTINDEXPAIR:

            return"caKeyCertIndexPair";

        case EXTENSIONVALUE_MASK_MSSTRING:

            return"msString";

    }

    return "";

}

PANSC_ATTR_OBJECT
AnscAsn1ExtensionValueCreateSelectionAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(selType);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

LONG
AnscAsn1ExtensionValueGetChoiceByOID
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pOIDString
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    if( pOIDString == NULL)         return -1;

    if( AnscEqualString1(pOIDString,"2.5.29.35",FALSE))
    {
        return EXTENSIONVALUE_MASK_AUTHORITYKEYIDENTIFIER;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.14",FALSE))
    {
        return EXTENSIONVALUE_MASK_SUBJECTKEYIDENTIFIER;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.15",FALSE))
    {
        return EXTENSIONVALUE_MASK_KEYUSAGE;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.16",FALSE))
    {
        return EXTENSIONVALUE_MASK_PRIVATEKEYUSAGEPERIOD;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.32",FALSE))
    {
        return EXTENSIONVALUE_MASK_CERTPOLICIES;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.33",FALSE))
    {
        return EXTENSIONVALUE_MASK_POLICYMAPPINGS;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.17",FALSE))
    {
        return EXTENSIONVALUE_MASK_SUBJECTALTNAME;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.18",FALSE))
    {
        return EXTENSIONVALUE_MASK_ISSERALTNAME;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.9",FALSE))
    {
        return EXTENSIONVALUE_MASK_SUBDIRECTORYATTRIBUTES;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.19",FALSE))
    {
        return EXTENSIONVALUE_MASK_BASICCONSTRAINTS;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.30",FALSE))
    {
        return EXTENSIONVALUE_MASK_NAMECONSTRAINTS;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.36",FALSE))
    {
        return EXTENSIONVALUE_MASK_POLICYCONSTRAINTS;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.31",FALSE))
    {
        return EXTENSIONVALUE_MASK_CRLDISTPOINTSSYNTAX;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.37",FALSE))
    {
        return EXTENSIONVALUE_MASK_EXTKEYUSAGESYNTAX;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.20",FALSE))
    {
        return EXTENSIONVALUE_MASK_CRLNUMBER;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.28",FALSE))
    {
        return EXTENSIONVALUE_MASK_ISSUINGDISTRIBUTIONPOINT;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.27",FALSE))
    {
        return EXTENSIONVALUE_MASK_DELTACRLINDICATOR;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.21",FALSE))
    {
        return EXTENSIONVALUE_MASK_CRLREASON;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.29",FALSE))
    {
        return EXTENSIONVALUE_MASK_CERTIFICATEISSUER;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.23",FALSE))
    {
        return EXTENSIONVALUE_MASK_HOLDINSTRUCTIONCODE;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.24",FALSE))
    {
        return EXTENSIONVALUE_MASK_INVALIDITYDATE;
    }
    else if( AnscEqualString1(pOIDString,"1.3.6.1.4.1.311.21.4",FALSE))
    {
        return EXTENSIONVALUE_MASK_INVALIDITYDATE;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.46",FALSE))
    {
        return EXTENSIONVALUE_MASK_CRLDISTPOINTSSYNTAX;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.1",FALSE))
    {
        return EXTENSIONVALUE_MASK_AUTHORITYKEYIDENTIFIER;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.3",FALSE))
    {
        return EXTENSIONVALUE_MASK_CERTPOLICIES;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.5",FALSE))
    {
        return EXTENSIONVALUE_MASK_POLICYMAPPINGS;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.7",FALSE))
    {
        return EXTENSIONVALUE_MASK_SUBJECTALTNAME;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.8",FALSE))
    {
        return EXTENSIONVALUE_MASK_ISSERALTNAME;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.10",FALSE))
    {
        return EXTENSIONVALUE_MASK_BASICCONSTRAINTS;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.13",FALSE))
    {
        return EXTENSIONVALUE_MASK_BASICCONSTRAINTS;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.11",FALSE))
    {
        return EXTENSIONVALUE_MASK_NAMECONSTRAINTS;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.12",FALSE))
    {
        return EXTENSIONVALUE_MASK_POLICYCONSTRAINTS;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.34",FALSE))
    {
        return EXTENSIONVALUE_MASK_POLICYCONSTRAINTS;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.25",FALSE))
    {
        return EXTENSIONVALUE_MASK_CRLDISTPOINTSSYNTAX;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.26",FALSE))
    {
        return EXTENSIONVALUE_MASK_ISSUINGDISTRIBUTIONPOINT;
    }
    else if( AnscEqualString1(pOIDString,"1.3.6.1.5.5.7.1.1",FALSE))
    {
        return EXTENSIONVALUE_MASK_AUTHINFOACCESSSYNTAX;
    }
    else if( AnscEqualString1(pOIDString,"1.3.6.1.5.5.7.1.11",FALSE))
    {
        return EXTENSIONVALUE_MASK_AUTHINFOACCESSSYNTAX;
    }
    else if( AnscEqualString1(pOIDString,"1.3.6.1.5.5.7.1.2",FALSE))
    {
        return EXTENSIONVALUE_MASK_BIOMETRICSSYNTAX;
    }
    else if( AnscEqualString1(pOIDString,"1.3.6.1.5.5.7.1.3",FALSE))
    {
        return EXTENSIONVALUE_MASK_QCSTATEMENTSSYNTAX;
    }
    else if( AnscEqualString1(pOIDString,"2.16.840.1.113730.1.1",FALSE))
    {
        return EXTENSIONVALUE_MASK_NETSCAPECERTTYPE;
    }
    else if( AnscEqualString1(pOIDString,"2.16.840.1.113730.1.2",FALSE))
    {
        return EXTENSIONVALUE_MASK_NETSCAPECOMMENT;
    }
    else if( AnscEqualString1(pOIDString,"2.16.840.1.113730.1.3",FALSE))
    {
        return EXTENSIONVALUE_MASK_NETSCAPECOMMENT;
    }
    else if( AnscEqualString1(pOIDString,"2.16.840.1.113730.1.4",FALSE))
    {
        return EXTENSIONVALUE_MASK_NETSCAPECOMMENT;
    }
    else if( AnscEqualString1(pOIDString,"2.16.840.1.113730.1.7",FALSE))
    {
        return EXTENSIONVALUE_MASK_NETSCAPECOMMENT;
    }
    else if( AnscEqualString1(pOIDString,"2.16.840.1.113730.1.8",FALSE))
    {
        return EXTENSIONVALUE_MASK_NETSCAPECOMMENT;
    }
    else if( AnscEqualString1(pOIDString,"2.16.840.1.113730.1.12",FALSE))
    {
        return EXTENSIONVALUE_MASK_NETSCAPECOMMENT;
    }
    else if( AnscEqualString1(pOIDString,"2.16.840.1.113730.1.13",FALSE))
    {
        return EXTENSIONVALUE_MASK_NETSCAPECOMMENT;
    }
    else if( AnscEqualString1(pOIDString,"2.5.4.3",FALSE))
    {
        return EXTENSIONVALUE_MASK_COMMONNAME;
    }
    else if( AnscEqualString1(pOIDString,"1.2.840.113533.7.65.0",FALSE))
    {
        return EXTENSIONVALUE_MASK_ENTRUSTVERSIONINFO;
    }
    else if( AnscEqualString1(pOIDString,"1.3.6.1.4.1.311.21.1",FALSE))
    {
        return EXTENSIONVALUE_MASK_CAKEYCERTINDEXPAIR;
    }
    else if( AnscEqualString1(pOIDString,"1.3.6.1.4.1.311.20.2",FALSE))
    {
        return EXTENSIONVALUE_MASK_MSSTRING;
    }

    return -1;

}

PCHAR
AnscAsn1ExtensionValueGetOIDValueByMask
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( selType )
    {
        case EXTENSIONVALUE_MASK_AUTHORITYKEYIDENTIFIER:

             return "2.5.29.35";

        case EXTENSIONVALUE_MASK_SUBJECTKEYIDENTIFIER:

             return "2.5.29.14";

        case EXTENSIONVALUE_MASK_KEYUSAGE:

             return "2.5.29.15";

        case EXTENSIONVALUE_MASK_PRIVATEKEYUSAGEPERIOD:

             return "2.5.29.16";

        case EXTENSIONVALUE_MASK_CERTPOLICIES:

             return "2.5.29.32";

        case EXTENSIONVALUE_MASK_POLICYMAPPINGS:

             return "2.5.29.33";

        case EXTENSIONVALUE_MASK_SUBJECTALTNAME:

             return "2.5.29.17";

        case EXTENSIONVALUE_MASK_ISSERALTNAME:

             return "2.5.29.18";

        case EXTENSIONVALUE_MASK_SUBDIRECTORYATTRIBUTES:

             return "2.5.29.9";

        case EXTENSIONVALUE_MASK_BASICCONSTRAINTS:

             return "2.5.29.19";

        case EXTENSIONVALUE_MASK_NAMECONSTRAINTS:

             return "2.5.29.30";

        case EXTENSIONVALUE_MASK_POLICYCONSTRAINTS:

             return "2.5.29.36";

        case EXTENSIONVALUE_MASK_CRLDISTPOINTSSYNTAX:

             return "2.5.29.31";

        case EXTENSIONVALUE_MASK_EXTKEYUSAGESYNTAX:

             return "2.5.29.37";

        case EXTENSIONVALUE_MASK_CRLNUMBER:

             return "2.5.29.20";

        case EXTENSIONVALUE_MASK_ISSUINGDISTRIBUTIONPOINT:

             return "2.5.29.28";

        case EXTENSIONVALUE_MASK_DELTACRLINDICATOR:

             return "2.5.29.27";

        case EXTENSIONVALUE_MASK_CRLREASON:

             return "2.5.29.21";

        case EXTENSIONVALUE_MASK_CERTIFICATEISSUER:

             return "2.5.29.29";

        case EXTENSIONVALUE_MASK_HOLDINSTRUCTIONCODE:

             return "2.5.29.23";

        case EXTENSIONVALUE_MASK_INVALIDITYDATE:

             return "2.5.29.24";

        /*
        case EXTENSIONVALUE_MASK_CRLDISTPOINTSSYNTAX:

             return "2.5.29.46";
        */

        /*
        case EXTENSIONVALUE_MASK_AUTHORITYKEYIDENTIFIER:

             return "2.5.29.1";
        */

        /*
        case EXTENSIONVALUE_MASK_CERTPOLICIES:

             return "2.5.29.3";
        */

        /*
        case EXTENSIONVALUE_MASK_POLICYMAPPINGS:

             return "2.5.29.5";
        */

        /*
        case EXTENSIONVALUE_MASK_SUBJECTALTNAME:

             return "2.5.29.7";
        */

        /*
        case EXTENSIONVALUE_MASK_ISSERALTNAME:

             return "2.5.29.8";
        */

        /*
        case EXTENSIONVALUE_MASK_BASICCONSTRAINTS:

             return "2.5.29.10";
        */

        /*
        case EXTENSIONVALUE_MASK_BASICCONSTRAINTS:

             return "2.5.29.13";
        */

        /*
        case EXTENSIONVALUE_MASK_NAMECONSTRAINTS:

             return "2.5.29.11";
        */

        /*
        case EXTENSIONVALUE_MASK_POLICYCONSTRAINTS:

             return "2.5.29.12";
        */

        /*
        case EXTENSIONVALUE_MASK_POLICYCONSTRAINTS:

             return "2.5.29.34";
        */

        /*
        case EXTENSIONVALUE_MASK_CRLDISTPOINTSSYNTAX:

             return "2.5.29.25";
        */

        /*
        case EXTENSIONVALUE_MASK_ISSUINGDISTRIBUTIONPOINT:

             return "2.5.29.26";
        */

        case EXTENSIONVALUE_MASK_AUTHINFOACCESSSYNTAX:

             return "1.3.6.1.5.5.7.1.1";

        /*
        case EXTENSIONVALUE_MASK_AUTHINFOACCESSSYNTAX:

             return "1.3.6.1.5.5.7.1.11";
        */

        case EXTENSIONVALUE_MASK_BIOMETRICSSYNTAX:

             return "1.3.6.1.5.5.7.1.2";

        case EXTENSIONVALUE_MASK_QCSTATEMENTSSYNTAX:

             return "1.3.6.1.5.5.7.1.3";

        case EXTENSIONVALUE_MASK_NETSCAPECERTTYPE:

             return "2.16.840.1.113730.1.1";

        case EXTENSIONVALUE_MASK_NETSCAPECOMMENT:

             return "2.16.840.1.113730.1.2";

        /*
        case EXTENSIONVALUE_MASK_NETSCAPECOMMENT:

             return "2.16.840.1.113730.1.3";
        */

        /*
        case EXTENSIONVALUE_MASK_NETSCAPECOMMENT:

             return "2.16.840.1.113730.1.4";
        */

        /*
        case EXTENSIONVALUE_MASK_NETSCAPECOMMENT:

             return "2.16.840.1.113730.1.7";
        */

        /*
        case EXTENSIONVALUE_MASK_NETSCAPECOMMENT:

             return "2.16.840.1.113730.1.8";
        */

        /*
        case EXTENSIONVALUE_MASK_NETSCAPECOMMENT:

             return "2.16.840.1.113730.1.12";
        */

        /*
        case EXTENSIONVALUE_MASK_NETSCAPECOMMENT:

             return "2.16.840.1.113730.1.13";
        */

        case EXTENSIONVALUE_MASK_COMMONNAME:

             return "2.5.4.3";

        case EXTENSIONVALUE_MASK_ENTRUSTVERSIONINFO:

             return "1.2.840.113533.7.65.0";

        case EXTENSIONVALUE_MASK_CAKEYCERTINDEXPAIR:

             return "1.3.6.1.4.1.311.21.1";

        case EXTENSIONVALUE_MASK_MSSTRING:

             return "1.3.6.1.4.1.311.20.2";

    }

    return NULL;

}


