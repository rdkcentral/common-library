/*
 * If not stated otherwise in this file or this component's Licenses.txt file the
 * following copyright and licenses apply:
 *
 * Copyright 2015 RDK Management
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
*/

/**********************************************************************
   Copyright [2014] [Cisco Systems, Inc.]
 
   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at
 
       http://www.apache.org/licenses/LICENSE-2.0
 
   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
**********************************************************************/

/**********************************************************************

    MODULE: ansc_asn1_Name.c

        ASN.1 ANSC Code Generated by Cisco Systems, Inc.

    ---------------------------------------------------------------

    DESCRIPTION:

        The ASN.1 objects implemented in this file

        *   ANSC_ASN1_NAME
        *   ANSC_ASN1_RDNSEQUENCE
        *   ANSC_ASN1_ATTRIBUTE
        *   ANSC_ASN1_RELATIVEDISTINGUISHEDNAME
        *   ANSC_ASN1_ATTRIBUTETYPEANDVALUE
        *   ANSC_ASN1_ATTRIBUTEVALUES
        *   ANSC_ASN1_ATTRIBUTEVALUE
        *   ANSC_ASN1_X520NAME
        *   ANSC_ASN1_UNSTRUCTUREDNAME
        *   ANSC_ASN1_DIRECTORYSTRING
        *   ANSC_ASN1_MESSAGEDIGEST
        *   ANSC_ASN1_SIGNINGTIME
        *   ANSC_ASN1_CHLLENGEPASSWORD
        *   ANSC_ASN1_UNSTRUCTUREDADDRESS
        *   ANSC_ASN1_CONTENTTYPE
        *   ANSC_ASN1_X520COMMONNAME
        *   ANSC_ASN1_X520LOCALITYNAME


    ---------------------------------------------------------------

    ENVIRONMENT:

        platform independent

    ---------------------------------------------------------------

    AUTHOR:

        ASNMAGIC ANSC CODE GENERATOR 1.0

    ---------------------------------------------------------------

    REVISION HISTORY:

        *   05/07/2002  initial revision

 **********************************************************************/


#include "ansc_asn1_advanced_local.h"
#include "ansc_string_util.h"
#include "safec_lib_common.h"

/**********************************************************************

 OBJECT -- ANSC_ASN1_NAME

 Name ::= Choice 
     {
                       rdnSequence RDNSequence 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateName
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_NAME                 pThisObject  = NULL;
    PANSC_ASN1_RDNSEQUENCE          pRDN         = NULL;

    /*
     * Create the base ASN.1 object.
     */
    if( hReserved != NULL)
    {
        pThisObject = (PANSC_ASN1_NAME)
            AnscAsn1CreateChoice
                (
                    hReserved
                );
    }
    else
    {
        pThisObject = (PANSC_ASN1_NAME)
            AnscAsn1CreateChoice
                (
                    (ANSC_HANDLE)sizeof(ANSC_ASN1_NAME)
                );
    }

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_NAME");
    pThisObject->SetName(pThisObject, "Name");

    pThisObject->Create             = AnscAsn1CreateName;
    pThisObject->CreateSelection    = AnscAsn1NameCreateSelection;
    pThisObject->GetSelectionName   = AnscAsn1NameGetSelectionName;
    pThisObject->CreateSelectionAttr= AnscAsn1NameCreateSelectionAttr;
    pThisObject->GetChoiceTagValue  = AnscAsn1NameGetChoiceTagValue;

    pThisObject->InitAttribute      = AnscAsn1NameInitAttribute;
    pThisObject->AddRDNAttribute    = AnscAsn1NameAddRDNAttribute;
    pThisObject->ExportToString     = AnscAsn1NameExportToString;
    pThisObject->GetCommonName      = AnscAsn1NameGetCommonName;
    pThisObject->GetNameByOID       = AnscAsn1NameGetNameByOID;
    pThisObject->IsNameEmpty        = AnscAsn1NameIsNameEmpty;

    pThisObject->uTotalChoice       = NAME_MAXI_MASK + 1;
    pThisObject->bChoiceByOID       = FALSE;

    if( pRDN == NULL)
    {
        /* RDN was not created, create it now */
        pRDN = (PANSC_ASN1_RDNSEQUENCE)
            pThisObject->CreateSelection(pThisObject,NAME_MASK_RDNSEQUENCE);

        if( pRDN != NULL)
        {
            pThisObject->SetSelection(pThisObject, NAME_MASK_RDNSEQUENCE, pRDN);
        }
    }

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1NameCreateSelection
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_CHOICE               pParent         = (PANSC_ASN1_CHOICE)hThisObject;

    switch( index )
    {

        case NAME_MASK_RDNSEQUENCE:

            pThisObject = AnscAsn1CreateRDNSequence(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PCHAR
AnscAsn1NameGetSelectionName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( selType )
    {
        case NAME_MASK_RDNSEQUENCE:

            return"rdnSequence";

    }

    return "";

}

PANSC_ATTR_OBJECT
AnscAsn1NameCreateSelectionAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(selType);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

BOOLEAN
AnscAsn1NameGetChoiceTagValue
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       uIndex,
        PASN_OBJECT_FORM_TYPE       pAttr,
        PULONG                      pTagValue
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(uIndex);
    UNREFERENCED_PARAMETER(pAttr);
    UNREFERENCED_PARAMETER(pTagValue);
    return FALSE;

}

/*
 *  Manually added functions;
 */
static BOOLEAN
addSingleAttribute
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pValue,
        PCHAR                       pAttrTypeOID
    )
{
    PANSC_ASN1_NAME                 pThisObject  = (PANSC_ASN1_NAME)hThisObject;
    PANSC_ASN1_PRINTABLESTRING      pPrintable;
    ULONG                           uLength;

    uLength = AnscSizeOfString(pValue);

    if( uLength == 0)
    {
        return TRUE;
    }

    pPrintable = AnscAsn1CreatePrintableString(NULL);

    if( pPrintable == NULL)
    {
        return FALSE;
    }

    pPrintable->SetStringValue
        (
            pPrintable, 
            (PUCHAR)pValue,
            AnscSizeOfString(pValue)
        );

    pThisObject->AddRDNAttribute
        (
            pThisObject,
            pAttrTypeOID,
            pPrintable
        );

    return TRUE;
}

static BOOLEAN
addRDNAttribute
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pString,
        PCHAR                       pAttrTypeOID
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    CHAR                            pTempBuffer[128]    = { 0 };
    PCHAR                           pBack, pBuffer;
    errno_t                         rc = -1;

    if (! pString[0])
    {
        return TRUE;
    }

    rc = strcpy_s( pTempBuffer, sizeof(pTempBuffer), pString);
    ERR_CHK(rc);

    pBuffer = pTempBuffer;
    pBack   = AnscStrChr(pBuffer, ';');

    while(pBack != NULL)
    {
        pBuffer[pBack - pBuffer] = 0;

        if(! addSingleAttribute(hThisObject, pBuffer, pAttrTypeOID))
        {
            return FALSE;
        }
       
        pBuffer = pBack + 1;

        pBack = AnscStrChr(pBuffer, ';');
    }

    if( AnscSizeOfString(pBuffer) > 0)
    {
        if(! addSingleAttribute(hThisObject, pBuffer, pAttrTypeOID))
        {
            return FALSE;
        }
    }

    return TRUE;
}

BOOLEAN
AnscAsn1NameInitAttribute
    (
        ANSC_HANDLE                 hThisObject,
        PALCERTIFICATE_ATTRIBUTE    pAttrObject
    )
{
    PANSC_ASN1_NAME                 pThisObject  = (PANSC_ASN1_NAME)hThisObject;
    PANSC_ASN1_PRINTABLESTRING      pPrintable;
    PANSC_ASN1_IA5STRING            pIA5String;
    PCHAR                           pValue;

    if( hThisObject == NULL || pAttrObject == NULL)
    {
        return FALSE;
    }

    /* Check CountryName */
    pValue = pAttrObject->GetCountryName(pAttrObject);

    if( !addRDNAttribute(hThisObject, pValue, "2.5.4.6"))
    {
        return FALSE;
    }

    /* Check OrganizationName */
    pValue = pAttrObject->GetOrganizationName(pAttrObject);

    if( !addRDNAttribute(hThisObject, pValue, "2.5.4.10"))
    {
        return FALSE;
    }

    /* Check OrganizationUnitName */
    pValue = pAttrObject->GetOrganUnitName(pAttrObject);

    if( !addRDNAttribute(hThisObject, pValue, "2.5.4.11"))
    {
        return FALSE;
    }

    /* Check CommonName */
    pValue = pAttrObject->GetCommonName(pAttrObject);

    if( !addRDNAttribute(hThisObject, pValue, "2.5.4.3"))
    {
        return FALSE;
    }

    /* check locality name */
    pValue = pAttrObject->GetLocalityName(pAttrObject);

    if( !addRDNAttribute(hThisObject, pValue, "2.5.4.7"))
    {
        return FALSE;
    }

    /* Check SerialNumber */
    pValue = pAttrObject->GetSerialNumber(pAttrObject);

    if( !addRDNAttribute(hThisObject, pValue, "2.5.4.5"))
    {
        return FALSE;
    }

    /* Check Street Address */
    pValue = pAttrObject->GetStreetAddress(pAttrObject);

    if( !addRDNAttribute(hThisObject, pValue, "2.5.4.9"))
    {
        return FALSE;
    }

    /* Check StateOrProvinceName */
    pValue = pAttrObject->GetStateOrProvinceName(pAttrObject);

    if( !addRDNAttribute(hThisObject, pValue, "2.5.4.8"))
    {
        return FALSE;
    }

    /* Add Title */
    pValue = pAttrObject->GetTitle(pAttrObject);

    if( !addRDNAttribute(hThisObject, pValue, "2.5.4.12"))
    {
        return FALSE;
    }

    /* check the DNS name */
    pValue = pAttrObject->GetDNQualifier(pAttrObject);

    if( !addRDNAttribute(hThisObject, pValue, "2.5.4.46"))
    {
        return FALSE;
    }

    /* Check UnstructuredName */
    pValue = pAttrObject->GetUnstructedName(pAttrObject);

    if( AnscSizeOfString(pValue) > 0)
    {
        pIA5String = AnscAsn1CreateIA5String(NULL);

        if( pIA5String == NULL)
        {
            AnscTrace("Failed to create IA5 string.\n");

            return FALSE;
        }
        pIA5String->SetStringValue
            (
                pIA5String, 
                (PUCHAR)pValue,
                AnscSizeOfString(pValue)
            );

        pThisObject->AddRDNAttribute
            (
                pThisObject,
                "1.2.840.113549.1.9.2",
                pIA5String
            );
    }

    /* Check UnstructuredAddress */
    pValue = pAttrObject->GetUnstructedAddress(pAttrObject);

    if( AnscSizeOfString(pValue) > 0)
    {
        pPrintable = AnscAsn1CreatePrintableString(NULL);

        if( pPrintable == NULL)
        {
            AnscTrace("Failed to create printable string.\n");

            return FALSE;
        }
        pPrintable->SetStringValue
            (
                pPrintable, 
                (PUCHAR)pValue,
                AnscSizeOfString(pValue)
            );

        pThisObject->AddRDNAttribute
            (
                pThisObject,
                "1.2.840.113549.1.9.8",
                pPrintable
            );
    }

    /* Check EmailAddress */
    pValue = pAttrObject->GetPKCS9Email(pAttrObject);

    if( AnscSizeOfString(pValue) > 0)
    {
        pIA5String = AnscAsn1CreateIA5String(NULL);

        if( pIA5String == NULL)
        {
            AnscTrace("Failed to create IA5 string.\n");

            return FALSE;
        }
        pIA5String->SetStringValue
            (
                pIA5String, 
                (PUCHAR)pValue,
                AnscSizeOfString(pValue)
            );

        pThisObject->AddRDNAttribute
            (
                pThisObject,
                "1.2.840.113549.1.9.1",
                pIA5String
            );
    }

    return TRUE;
}

BOOLEAN
AnscAsn1NameAddRDNAttribute
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pOIDString,
        ANSC_HANDLE                 hValueHandle
    )
{
    PANSC_ASN1_NAME                 pThisObject  = (PANSC_ASN1_NAME)hThisObject;
    PANSC_ASN1_RDNSEQUENCE          pRDN;
    PANSC_ASN1_RELATIVEDISTINGUISHEDNAME
                                    pRDNChild;
    PANSC_ASN1_ATTRIBUTETYPEANDVALUE
                                    pTypeAndValue;

    if( pThisObject == NULL || pOIDString == NULL || hValueHandle == NULL)
    {
        return FALSE;
    }

    pRDN = (PANSC_ASN1_RDNSEQUENCE)pThisObject->GetSelection(pThisObject);

    if( pRDN == NULL)
    {
        /* RDN was not created, create it now */
        pRDN = (PANSC_ASN1_RDNSEQUENCE)
            pThisObject->CreateSelection(pThisObject,NAME_MASK_RDNSEQUENCE);

        if( pRDN == NULL)
        {
            return FALSE;
        }

        pThisObject->SetSelection(pThisObject, NAME_MASK_RDNSEQUENCE, pRDN);
    }

    pRDNChild = (PANSC_ASN1_RELATIVEDISTINGUISHEDNAME)pRDN->CreateChild(pRDN,TRUE);

    if( pRDNChild == NULL)
    {
        return FALSE;
    }

    pTypeAndValue = (PANSC_ASN1_ATTRIBUTETYPEANDVALUE)
        pRDNChild->CreateChild(pRDNChild, TRUE);

    if( pTypeAndValue == NULL)
    {
        return FALSE;
    }

    return 
        pTypeAndValue->SetTypeAndHandle
            (
                pTypeAndValue,
                pOIDString,
                hValueHandle
            );
}

BOOLEAN
AnscAsn1NameExportToString
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pBuffer,
        PULONG                      pLength
    )
{
    PANSC_ASN1_NAME                 pThisObject  = (PANSC_ASN1_NAME)hThisObject;
    PANSC_ASN1_RDNSEQUENCE          pRDNSequence;
    PANSC_ASN1_ATTRIBUTETYPEANDVALUE
                                    pTypeAndValue;
    PANSC_ASN1_RELATIVEDISTINGUISHEDNAME
                                    pRelative;
    CHAR                            pOneName[128]= { 0 };
    ULONG                           oneLength    = 128;
    ULONG                           length       = 0;
    ULONG                           i,j;

    if( hThisObject == NULL || pLength == NULL || pBuffer  == NULL)
    {
        return FALSE;
    }

    pRDNSequence = (PANSC_ASN1_RDNSEQUENCE)
        pThisObject->hSelection;

    if( pRDNSequence == NULL)
    {
        return FALSE;
    }

    for( i = 0; i < pRDNSequence->GetChildCount(pRDNSequence); i ++)
    {
        pRelative = (PANSC_ASN1_RELATIVEDISTINGUISHEDNAME)
            pRDNSequence->GetChildByIndex(pRDNSequence, i);

        if( pRelative != NULL)
        {
            for( j = 0; j < pRelative->GetChildCount(pRelative); j ++)
            {
                pTypeAndValue = (PANSC_ASN1_ATTRIBUTETYPEANDVALUE)
                    pRelative->GetChildByIndex(pRelative, j);

                if( pTypeAndValue != NULL)
                {
                    if(pTypeAndValue->ExportToString
                        (
                            pTypeAndValue,
                            pOneName,
                            &oneLength
                        ))
                    {
                        if( length + oneLength >= 512)
                        {
                            AnscTrace("Not enough buffer.\n");
                            return FALSE;
                        }
            
                        if( length != 0)
                        {
                            pBuffer[length] = ',';
                            length ++;
                        }

                        AnscCopyMemory
                            (
                                (PVOID)(pBuffer + length),
                                pOneName,
                                oneLength
                            );
                        length += oneLength;
                    }
                }
            }
        }

        oneLength = 128;
        AnscZeroMemory(pOneName, 128);
    }

    if( *pLength < length)
    {
        return FALSE;
    }

    *pLength = length;

    return TRUE;
}

BOOLEAN
AnscAsn1NameGetNameByOID
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pOIDString,
        PCHAR                       pString,
        PULONG                      pLength
    )
{
    PANSC_ASN1_NAME                 pThisObject  = (PANSC_ASN1_NAME)hThisObject;
    PANSC_ASN1_RDNSEQUENCE          pRDNSequence;
    PANSC_ASN1_ATTRIBUTETYPEANDVALUE
                                    pTypeAndValue;
    PANSC_ASN1_RELATIVEDISTINGUISHEDNAME
                                    pRelative;
    ULONG                           i,j;
    PANSC_ASN1_OIDEN                pOIDObject;
    PANSC_ASN1_OBJECT               pStrObject;
    PANSC_ASN1_ATTRIBUTEVALUE       pAttrValue;
    CHAR                            pOID[64]     = { 0 };
    PANSC_ASN1_STRING               pValueObj;

    if( hThisObject == NULL || pLength == NULL || pString  == NULL || pOIDString == NULL)
    {
        return FALSE;
    }

    pRDNSequence = (PANSC_ASN1_RDNSEQUENCE)
        pThisObject->hSelection;

    if( pRDNSequence == NULL)
    {
        return FALSE;
    }

    for( i = 0; i < pRDNSequence->GetChildCount(pRDNSequence); i ++)
    {
        pRelative = (PANSC_ASN1_RELATIVEDISTINGUISHEDNAME)
            pRDNSequence->GetChildByIndex(pRDNSequence, i);

        if( pRelative != NULL)
        {
            for( j = 0; j < pRelative->GetChildCount(pRelative); j ++)
            {
                pTypeAndValue = (PANSC_ASN1_ATTRIBUTETYPEANDVALUE)
                    pRelative->GetChildByIndex(pRelative, j);

                if( pTypeAndValue != NULL)
                {
                    pOIDObject = (PANSC_ASN1_OIDEN)pTypeAndValue->GetChildByIndex(pTypeAndValue,0);

                    pOIDObject->GetStringOIDValue(pOIDObject, pOID);

                    if(!strcasecmp(pOID, pOIDString) == 0 ) 
                    {
                        continue;
                    }

                    /* copy the string value */
                    pAttrValue = (PANSC_ASN1_ATTRIBUTEVALUE)
                        pTypeAndValue->GetChildByIndex(pTypeAndValue,1);

                    if( pAttrValue == NULL)
                    {
                        return FALSE;
                    }

                    pStrObject = (PANSC_ASN1_OBJECT)pAttrValue->hSelection;

                    while(pStrObject != NULL && pStrObject->uType == ASN1_CHOICE_TYPE)
                    {
                        pStrObject = (PANSC_ASN1_OBJECT)
                            ((PANSC_ASN1_CHOICE)pStrObject)->hSelection;
                    }

                    if( pStrObject == NULL)
                    {
                        return FALSE;
                    }

                    pValueObj = (PANSC_ASN1_STRING)pStrObject;

                    if( *pLength < pValueObj->uLength)
                    {
                        return FALSE;
                    }

                    *pLength = pValueObj->uLength;

                    AnscCopyMemory
                        (
                            pString,
                            pValueObj->GetValueBuffer(pValueObj),
                            *pLength
                        );

                    return TRUE;
                }
            }
        }
    }

    return FALSE;
}

BOOLEAN
AnscAsn1NameGetCommonName
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pString,
        PULONG                      pLength
    )
{
    PANSC_ASN1_NAME                 pThisObject  = (PANSC_ASN1_NAME)hThisObject;

    if( hThisObject == NULL || pLength == NULL || pString  == NULL)
    {
        return FALSE;
    }

    return pThisObject->GetNameByOID(pThisObject, "2.5.4.3", pString, pLength);

}

BOOLEAN
AnscAsn1NameIsNameEmpty
    (
        ANSC_HANDLE                 hThisObject
    )
{
    PANSC_ASN1_NAME                 pThisObject  = (PANSC_ASN1_NAME)hThisObject;
    PANSC_ASN1_RDNSEQUENCE          pRDNSequence;

    if( hThisObject == NULL)
    {
        return FALSE;
    }

    pRDNSequence = (PANSC_ASN1_RDNSEQUENCE)
        pThisObject->hSelection;

    if( pRDNSequence == NULL)
    {
        return FALSE;
    }

    return (pRDNSequence->GetChildCount(pRDNSequence) == 0);
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_RDNSEQUENCE

 RDNSequence ::= SequenceOf RelativeDistinguishedName  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateRDNSequence
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_RDNSEQUENCE          pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    if( hReserved != NULL)
    {
        pThisObject = (PANSC_ASN1_RDNSEQUENCE)
            AnscAsn1CreateSequenceOf
                (
                    hReserved
                );
    }
    else
    {
        pThisObject = (PANSC_ASN1_RDNSEQUENCE)
            AnscAsn1CreateSequenceOf
                (
                    (ANSC_HANDLE)sizeof(ANSC_ASN1_RDNSEQUENCE)
                );
    }

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_RDNSEQUENCE");
    pThisObject->SetName(pThisObject, "RDNSequence");

    pThisObject->Create             = AnscAsn1CreateRDNSequence;
    pThisObject->CreateChild        = AnscAsn1RDNSequenceCreateChild;
    pThisObject->IsChildValid       = AnscAsn1RDNSequenceIsChildValid;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1RDNSequenceCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreateRelativeDistinguishedName(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1RDNSequenceIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_RELATIVEDISTINGUISHEDNAME", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_ATTRIBUTE

 Attribute ::= Sequence 
     {
                     attributeType OID 
                             value AttributeValues 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateAttribute
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_ATTRIBUTE            pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    if( hReserved != NULL)
    {
        pThisObject = (PANSC_ASN1_ATTRIBUTE)
            AnscAsn1CreateSequence
                (
                    hReserved
                );
    }
    else
    {
        pThisObject = (PANSC_ASN1_ATTRIBUTE)
            AnscAsn1CreateSequence
                (
                    (ANSC_HANDLE)sizeof(ANSC_ASN1_ATTRIBUTE)
                );
    }

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_ATTRIBUTE");
    pThisObject->SetName(pThisObject, "Attribute");

    pThisObject->Create             = AnscAsn1CreateAttribute;
    pThisObject->CreateChildAttr    = AnscAsn1AttributeCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1AttributeGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1AttributeCreateChildObject;
    pThisObject->SetTypeAndStringValue
                                    = AnscAsn1AttributeSetTypeAndStringValue;
    pThisObject->SetTypeAndHandle   = AnscAsn1AttributeSetTypeAndHandle;

    pThisObject->uTotalChild        = 2;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1AttributeCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateOID(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateAttributeValues(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1AttributeCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(index);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

PCHAR
AnscAsn1AttributeGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{   
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( index )
    {
        case 0:

            return"attributeType";

        case 1:

            return"value";

    }

    return "";

}

/*
 *  Manually added functions
 */
BOOLEAN
AnscAsn1AttributeSetTypeAndStringValue
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pOIDString,
        PCHAR                       pValue,
        ULONG                       ulOfValue
    )
{
    PANSC_ASN1_ATTRIBUTE            pThisObject          = (PANSC_ASN1_ATTRIBUTE)hThisObject;
    PANSC_ASN1_OIDEN                pOIDObject;
    PANSC_ASN1_ATTRIBUTEVALUES      pAttrValues;
    PANSC_ASN1_ATTRIBUTEVALUE       pAttrValue;
    PANSC_ASN1_CHOICE               pSelection;
    PANSC_ASN1_PRINTABLESTRING      pStringObject;

    if( pThisObject == NULL || pOIDString == NULL || pValue == NULL)
    {
        return FALSE;
    }

    pOIDObject = (PANSC_ASN1_OIDEN)pThisObject->GetChildByIndex(pThisObject,0);

    if( pOIDObject != NULL)
    {
        pOIDObject->SetStringOIDValue(pOIDObject, pOIDString);
    }

    pAttrValues = (PANSC_ASN1_ATTRIBUTEVALUES)pThisObject->GetChildByIndex(pThisObject,1);

    if( pAttrValues == NULL)
    {
        return FALSE;
    }

    pAttrValue = (PANSC_ASN1_ATTRIBUTEVALUE)pAttrValues->CreateChild(pAttrValues, TRUE);

    if( pAttrValue == NULL)
    {
        return FALSE;
    }

    pSelection = (PANSC_ASN1_CHOICE)
        pAttrValue->CreateSelection(pAttrValue, ATTRIBUTEVALUE_MASK_X520COMMONNAME);
    
    pAttrValue->SetSelection
            ( 
                pAttrValue, 
                ATTRIBUTEVALUE_MASK_X520COMMONNAME,
                pSelection
            );

    if( pSelection != NULL)
    {
        pStringObject = (PANSC_ASN1_PRINTABLESTRING)
            pSelection->CreateSelection(pSelection, X520NAME_MASK_PRINTABLESTRING);

        pSelection->SetSelection( pSelection, X520NAME_MASK_PRINTABLESTRING,pStringObject);

        if( pStringObject != NULL)
        {
            pStringObject->SetStringValue(pStringObject, (PUCHAR)pValue, ulOfValue);
        }
    }

    return TRUE;
}

BOOLEAN
AnscAsn1AttributeSetTypeAndHandle
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pOIDString,
        ANSC_HANDLE                 hValue
    )
{
    PANSC_ASN1_ATTRIBUTE            pThisObject          = (PANSC_ASN1_ATTRIBUTE)hThisObject;
    PANSC_ASN1_OIDEN                pOIDObject;
    PANSC_ASN1_ATTRIBUTEVALUES      pAttrValues;
    PANSC_ASN1_ATTRIBUTEVALUE       pAttrValue;
    LONG                            lSelect;


    if( pThisObject == NULL || pOIDString == NULL || hValue == NULL)
    {
        return FALSE;
    }

    pOIDObject = (PANSC_ASN1_OIDEN)pThisObject->GetChildByIndex(pThisObject,0);

    if( pOIDObject != NULL)
    {
        pOIDObject->SetStringOIDValue(pOIDObject, pOIDString);
    }

    pAttrValues = (PANSC_ASN1_ATTRIBUTEVALUES)pThisObject->GetChildByIndex(pThisObject,1);

    if( pAttrValues == NULL)
    {
        return FALSE;
    }

    pAttrValue = (PANSC_ASN1_ATTRIBUTEVALUE)pAttrValues->CreateChild(pAttrValues, TRUE);

    if( pAttrValue == NULL)
    {
        return FALSE;
    }

    lSelect = pAttrValue->GetChoiceFromOID(pAttrValue, pOIDString);
    
    if( lSelect < 0)
    {
        lSelect = 0;
    }

    pAttrValue->SetSelection
        (
            pAttrValue, 
            lSelect, 
            hValue
        );

    return TRUE;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_RELATIVEDISTINGUISHEDNAME

 RelativeDistinguishedName ::= SetOf AttributeTypeAndValue  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateRelativeDistinguishedName
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_RELATIVEDISTINGUISHEDNAME 
                                    pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    if( hReserved != NULL)
    {
        pThisObject = (PANSC_ASN1_RELATIVEDISTINGUISHEDNAME)
            AnscAsn1CreateSetOf
                (
                    hReserved
                );
    }
    else
    {
        pThisObject = (PANSC_ASN1_RELATIVEDISTINGUISHEDNAME)
            AnscAsn1CreateSetOf
                (
                    (ANSC_HANDLE)sizeof(ANSC_ASN1_RELATIVEDISTINGUISHEDNAME)
                );
    }

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_RELATIVEDISTINGUISHEDNAME");
    pThisObject->SetName(pThisObject, "RelativeDistinguishedName");

    pThisObject->Create             = AnscAsn1CreateRelativeDistinguishedName;
    pThisObject->CreateChild        = AnscAsn1RelativeDistinguishedNameCreateChild;
    pThisObject->IsChildValid       = AnscAsn1RelativeDistinguishedNameIsChildValid;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1RelativeDistinguishedNameCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreateAttributeTypeAndValue(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1RelativeDistinguishedNameIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_ATTRIBUTETYPEANDVALUE", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_ATTRIBUTETYPEANDVALUE

 AttributeTypeAndValue ::= Sequence 
     {
                     attributeType OID 
                             value AttributeValue 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateAttributeTypeAndValue
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_ATTRIBUTETYPEANDVALUE 
                                    pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    if( hReserved != NULL)
    {
        pThisObject = (PANSC_ASN1_ATTRIBUTETYPEANDVALUE)
            AnscAsn1CreateSequence
                (
                    hReserved
                );
    }
    else
    {
        pThisObject = (PANSC_ASN1_ATTRIBUTETYPEANDVALUE)
            AnscAsn1CreateSequence
                (
                    (ANSC_HANDLE)sizeof(ANSC_ASN1_ATTRIBUTETYPEANDVALUE)
                );
    }

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_ATTRIBUTETYPEANDVALUE");
    pThisObject->SetName(pThisObject, "AttributeTypeAndValue");

    pThisObject->Create             = AnscAsn1CreateAttributeTypeAndValue;
    pThisObject->CreateChildAttr    = AnscAsn1AttributeTypeAndValueCreateChildAttr;
    pThisObject->GetChildName       = AnscAsn1AttributeTypeAndValueGetChildName;
    pThisObject->CreateChildObject  = AnscAsn1AttributeTypeAndValueCreateChildObject;
    pThisObject->SetTypeAndStringValue
                                    = AnscAsn1AttrTypeAndValueSetTypeAndStringValue;
    pThisObject->SetTypeAndHandle   = AnscAsn1AttrTypeAndValueSetTypeAndHandle;
    pThisObject->ExportToString     = AnscAsn1AttrTypeAndValueExportToString;

    pThisObject->uTotalChild        = 2;

    /*
     * Create all the children
     */
    pThisObject->CreateAllChildren(pThisObject);


    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1AttributeTypeAndValueCreateChildObject
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_SEQUENCE             pParent          = (PANSC_ASN1_SEQUENCE)hThisObject;

    switch( index )
    {

        case 0:

            pThisObject = AnscAsn1CreateOID(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

        case 1:

            pThisObject = AnscAsn1CreateAttributeValue(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateChildAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetChildName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PANSC_ATTR_OBJECT
AnscAsn1AttributeTypeAndValueCreateChildAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(index);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

PCHAR
AnscAsn1AttributeTypeAndValueGetChildName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    UNREFERENCED_PARAMETER(hThisObject);   
    switch ( index )
    {
        case 0:

            return"attributeType";

        case 1:

            return"value";

    }

    return "";

}

/*
 *  Manually added functions
 */
BOOLEAN
AnscAsn1AttrTypeAndValueSetTypeAndStringValue
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pOIDString,
        PCHAR                       pValue,
        ULONG                       ulOfValue
    )
{
    PANSC_ASN1_ATTRIBUTETYPEANDVALUE
                                    pThisObject          = (PANSC_ASN1_ATTRIBUTETYPEANDVALUE)hThisObject;
    PANSC_ASN1_OIDEN                pOIDObject;
    PANSC_ASN1_ATTRIBUTEVALUE       pAttrValue;
    PANSC_ASN1_CHOICE               pSelection;
    PANSC_ASN1_PRINTABLESTRING      pStringObject;

    if( pThisObject == NULL || pOIDString == NULL || pValue == NULL)
    {
        return FALSE;
    }

    pOIDObject = (PANSC_ASN1_OIDEN)pThisObject->GetChildByIndex(pThisObject,0);

    if( pOIDObject != NULL)
    {
        pOIDObject->SetStringOIDValue(pOIDObject, pOIDString);
    }

    pAttrValue = (PANSC_ASN1_ATTRIBUTEVALUE)pThisObject->GetChildByIndex(pThisObject,1);

    if( pAttrValue == NULL)
    {
        return FALSE;
    }

    pSelection = (PANSC_ASN1_CHOICE)
        pAttrValue->CreateSelection(pAttrValue, ATTRIBUTEVALUE_MASK_X520COMMONNAME);
    
    pAttrValue->SetSelection
            ( 
                pAttrValue, 
                ATTRIBUTEVALUE_MASK_X520COMMONNAME,
                pSelection
            );

    if( pSelection != NULL)
    {
        pStringObject = (PANSC_ASN1_PRINTABLESTRING)
            pSelection->CreateSelection(pSelection, X520NAME_MASK_PRINTABLESTRING);

        pSelection->SetSelection( pSelection, X520NAME_MASK_PRINTABLESTRING,pStringObject);

        if( pStringObject != NULL)
        {
            pStringObject->SetStringValue(pStringObject, (PUCHAR)pValue, ulOfValue);
        }
    }

    return TRUE;

}

BOOLEAN
AnscAsn1AttrTypeAndValueSetTypeAndHandle
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pOIDString,
        ANSC_HANDLE                 hValue
    )
{
    PANSC_ASN1_ATTRIBUTETYPEANDVALUE
                                    pThisObject          = (PANSC_ASN1_ATTRIBUTETYPEANDVALUE)hThisObject;
    PANSC_ASN1_OIDEN                pOIDObject;
    PANSC_ASN1_ATTRIBUTEVALUE       pAttrValue;

    if( pThisObject == NULL || pOIDString == NULL || hValue == NULL)
    {
        return FALSE;
    }

    pOIDObject = (PANSC_ASN1_OIDEN)pThisObject->GetChildByIndex(pThisObject,0);

    if( pOIDObject != NULL)
    {
        pOIDObject->SetStringOIDValue(pOIDObject, pOIDString);
    }

    pAttrValue = (PANSC_ASN1_ATTRIBUTEVALUE)pThisObject->GetChildByIndex(pThisObject,1);

    if( pAttrValue == NULL)
    {
        return FALSE;
    }
   
    pAttrValue->SetSelection
            ( 
                pAttrValue, 
                pAttrValue->GetChoiceFromOID(pAttrValue, pOIDString),
                hValue
            );

    return TRUE;

}

/**********************************************************************

    String  X.500 AttributeType
    ------------------------------
    CN      commonName
    L       localityName
    ST      stateOrProvinceName
    O       organizationName
    OU      organizationalUnitName
    C       countryName
    STREET  streetAddress
    SN      serialNumber

    Not supported here:

    DC      domainComponent
    UID     userid

 **********************************************************************/

BOOLEAN
AnscAsn1AttrTypeAndValueExportToString
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pBuffer,
        PULONG                      pLength
    )
{
    PANSC_ASN1_ATTRIBUTETYPEANDVALUE
                                    pThisObject          = (PANSC_ASN1_ATTRIBUTETYPEANDVALUE)hThisObject;
    PANSC_ASN1_OIDEN                pOIDObject;
    PANSC_ASN1_OBJECT               pStrObject;
    PANSC_ASN1_ATTRIBUTEVALUE       pAttrValue;
    CHAR                            pOID[64]             = { 0 };
    ULONG                           length               = 0;
    errno_t                         rc                   = -1;

    if(hThisObject == NULL || pBuffer == NULL || pLength == NULL)
    {
        return FALSE;
    }

    pOIDObject = (PANSC_ASN1_OIDEN)pThisObject->GetChildByIndex(pThisObject,0);

    if( pOIDObject == NULL)
    {
        return FALSE;
    }

    pOIDObject->GetStringOIDValue(pOIDObject, pOID);

    if( strcasecmp(pOID, "2.5.4.6") == 0 ) /* country name */
    {
        rc = strcpy_s( pBuffer, *pLength, X500_C);
        ERR_CHK(rc);
    }
    else if ( strcasecmp(pOID, "2.5.4.10") == 0 ) /* Organ Name*/
    {
        rc = strcpy_s( pBuffer, *pLength, X500_O);
        ERR_CHK(rc);
    }
    else if ( strcasecmp(pOID, "2.5.4.11") == 0 )  /* organunit name */
    {
        rc = strcpy_s( pBuffer, *pLength, X500_OU);
        ERR_CHK(rc);
    }
    else if ( strcasecmp(pOID, "2.5.4.3") == 0 ) /* common name */
    {
        rc = strcpy_s( pBuffer, *pLength, X500_CN);
        ERR_CHK(rc);
    }
    else if ( strcasecmp(pOID, "2.5.4.8") == 0 ) /* state name */
    {
        rc = strcpy_s( pBuffer, *pLength, X500_ST);
        ERR_CHK(rc);
    }
    else if ( strcasecmp(pOID, "2.5.4.7") == 0 )  /* locality name */
    {
        rc = strcpy_s( pBuffer, *pLength, X500_L);
        ERR_CHK(rc);
    }
    else if ( strcasecmp(pOID, "2.5.4.9") == 0 )  /* street address */
    {
        rc = strcpy_s( pBuffer, *pLength, X500_STREET);
        ERR_CHK(rc);
    }
    else if ( strcasecmp(pOID, "2.5.4.5") == 0 )  /* street address */
    {
        rc = strcpy_s( pBuffer, *pLength, X500_SN);
        ERR_CHK(rc);
    }
    else
    {
        return FALSE;
    }

    length = AnscSizeOfString(pBuffer);

    /* copy the string value */
    pAttrValue = (PANSC_ASN1_ATTRIBUTEVALUE)pThisObject->GetChildByIndex(pThisObject,1);
    if( pAttrValue == NULL)
    {
        return FALSE;
    }

    pStrObject = (PANSC_ASN1_OBJECT)pAttrValue->hSelection;

    while(pStrObject != NULL && pStrObject->uType == ASN1_CHOICE_TYPE)
    {
        pStrObject = (PANSC_ASN1_OBJECT)
            ((PANSC_ASN1_CHOICE)pStrObject)->hSelection;
    }

    if( pStrObject == NULL)
    {
        return FALSE;
    }

    pBuffer[length] = '=';
    length ++;

    AnscCopyMemory
        (
            (PVOID)(pBuffer + length),
            ((PANSC_ASN1_STRING)pStrObject)->GetValueBuffer(pStrObject),
            ((PANSC_ASN1_STRING)pStrObject)->uLength
        );

    length  += ((PANSC_ASN1_STRING)pStrObject)->uLength;
    *pLength = length;

    return TRUE;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_ATTRIBUTEVALUES

 AttributeValues ::= SetOf AttributeValue  {}

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateAttributeValues
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_ATTRIBUTEVALUES      pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    if( hReserved != NULL)
    {
        pThisObject = (PANSC_ASN1_ATTRIBUTEVALUES)
            AnscAsn1CreateSetOf
                (
                    hReserved
                );
    }
    else
    {
        pThisObject = (PANSC_ASN1_ATTRIBUTEVALUES)
            AnscAsn1CreateSetOf
                (
                    (ANSC_HANDLE)sizeof(ANSC_ASN1_ATTRIBUTEVALUES)
                );
    }

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_ATTRIBUTEVALUES");
    pThisObject->SetName(pThisObject, "AttributeValues");

    pThisObject->Create             = AnscAsn1CreateAttributeValues;
    pThisObject->CreateChild        = AnscAsn1AttributeValuesCreateChild;
    pThisObject->IsChildValid       = AnscAsn1AttributeValuesIsChildValid;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1AttributeValuesCreateChild
    (
        ANSC_HANDLE                 hThisObject,
        BOOLEAN                     bAddItIn
    )
{
    PANSC_ASN1_SETOF                pParentObj   = (PANSC_ASN1_SETOF)hThisObject;
    PANSC_ASN1_OBJECT               pThisObject  = NULL;

    pThisObject  = AnscAsn1CreateAttributeValue(NULL);

    if( pThisObject != NULL && bAddItIn)
    {
        pParentObj->AddChild(pParentObj,pThisObject);
    }

    return pThisObject;
}

ANSC_STATUS
AnscAsn1AttributeValuesIsChildValid
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hChild
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    PANSC_ASN1_OBJECT               pChild    = (PANSC_ASN1_OBJECT)hChild;

    if( pChild == NULL)
    {
        return ANSC_ASN1_NULL_OBJCET;
    }

    if( !AnscEqualString1(pChild->ClassName, "ANSC_ASN1_ATTRIBUTEVALUE", TRUE))
    {
        return ANSC_ASN1_INVALID_TYPE_IN_SEQOF_OR_SETOF;
    }

    return ANSC_STATUS_SUCCESS;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_ATTRIBUTEVALUE

 AttributeValue ::= Choice 
     {
                   x520dnQualifier PrintableString 
                       countryName PrintableString 
                 pkcs9EmailAddress IA5String 
                       contentType ContentType 
                  unstructuredName UnstructuredName 
                     messageDigest MessageDigest 
                       signingTime SigningTime 
                 challengePassword ChllengePassword 
               unstructuredAddress UnstructuredAddress 
                         bmpString BMPString 
                          x520Name X520name 
                    x520CommonName X520CommonName 
                        signerInfo SignerInfo 
                   pkcs9LocalKeyID OctetString 
                          keyUsage BitString 
                        utf8String UTF8String 
                      genderString PrintableString 
              printableCountryName PrintableString 
                      localityName X520LocalityName 
                   domainComponent DirectoryString 
                         t61String TeletexString 
                        extensions Extensions 
                     streetAddress DirectoryString
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateAttributeValue
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_ATTRIBUTEVALUE       pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    if( hReserved != NULL)
    {
        pThisObject = (PANSC_ASN1_ATTRIBUTEVALUE)
            AnscAsn1CreateChoice
                (
                    hReserved
                );
    }
    else
    {
        pThisObject = (PANSC_ASN1_ATTRIBUTEVALUE)
            AnscAsn1CreateChoice
                (
                    (ANSC_HANDLE)sizeof(ANSC_ASN1_ATTRIBUTEVALUE)
                );
    }

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_ATTRIBUTEVALUE");
    pThisObject->SetName(pThisObject, "AttributeValue");

    pThisObject->Create             = AnscAsn1CreateAttributeValue;
    pThisObject->CreateSelection    = AnscAsn1AttributeValueCreateSelection;
    pThisObject->GetSelectionName   = AnscAsn1AttributeValueGetSelectionName;
    pThisObject->CreateSelectionAttr= AnscAsn1AttributeValueCreateSelectionAttr;
    pThisObject->GetChoiceFromOID   = AnscAsn1AttributeValueGetChoiceByOID;
    pThisObject->GetOIDValueByMask  = AnscAsn1AttributeValueGetOIDValueByMask;
    pThisObject->uTotalChoice       = ATTRIBUTEVALUE_MAXI_MASK + 1;
    pThisObject->bChoiceByOID       = TRUE;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1AttributeValueCreateSelection
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_CHOICE               pParent         = (PANSC_ASN1_CHOICE)hThisObject;

    switch( index )
    {

        case ATTRIBUTEVALUE_MASK_X520DNQUALIFIER:

            pThisObject = AnscAsn1CreatePrintableString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_COUNTRYNAME:

            pThisObject = AnscAsn1CreatePrintableString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_PKCS9EMAILADDRESS:

            pThisObject = AnscAsn1CreateIA5String(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_CONTENTTYPE:

            pThisObject = AnscAsn1CreateContentType(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_UNSTRUCTUREDNAME:

            pThisObject = AnscAsn1CreateUnstructuredName(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_MESSAGEDIGEST:

            pThisObject = AnscAsn1CreateMessageDigest(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_SIGNINGTIME:

            pThisObject = AnscAsn1CreateSigningTime(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_CHALLENGEPASSWORD:

            pThisObject = AnscAsn1CreateChllengePassword(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_UNSTRUCTUREDADDRESS:

            pThisObject = AnscAsn1CreateUnstructuredAddress(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_BMPSTRING:

            pThisObject = AnscAsn1CreateBMPString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_X520NAME:

            pThisObject = AnscAsn1CreateX520name(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_X520COMMONNAME:

            pThisObject = AnscAsn1CreateX520CommonName(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_SIGNERINFO:

#ifndef _ANSC_CERT_ONLY_

            pThisObject = AnscAsn1CreateSignerInfo(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

#endif

            break;

        case ATTRIBUTEVALUE_MASK_PKCS9LOCALKEYID:

            pThisObject = AnscAsn1CreateOctetString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_KEYUSAGE:

            pThisObject = AnscAsn1CreateBitString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_UTF8STRING:

            pThisObject = AnscAsn1CreateUTF8String(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_GENDERSTRING:

            pThisObject = AnscAsn1CreatePrintableString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_PRINTABLECOUNTRYNAME:

            pThisObject = AnscAsn1CreatePrintableString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_LOCALITYNAME:

            pThisObject = AnscAsn1CreateX520LocalityName(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_DOMAINCOMPONENT:
        case ATTRIBUTEVALUE_MASK_STREETADDRESS:

            pThisObject = AnscAsn1CreateDirectoryString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_T61STRING:

            pThisObject = AnscAsn1CreateTeletexString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case ATTRIBUTEVALUE_MASK_EXTENSIONS:

            pThisObject = AnscAsn1CreateExtensions(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;
    }

    return pThisObject;

}

PCHAR
AnscAsn1AttributeValueGetSelectionName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{

#ifndef _PKI_KERNEL
    UNREFERENCED_PARAMETER(hThisObject);    
    switch ( selType )
    {
        case ATTRIBUTEVALUE_MASK_X520DNQUALIFIER:

            return"x520dnQualifier";

        case ATTRIBUTEVALUE_MASK_COUNTRYNAME:

            return"countryName";

        case ATTRIBUTEVALUE_MASK_PKCS9EMAILADDRESS:

            return"pkcs9EmailAddress";

        case ATTRIBUTEVALUE_MASK_CONTENTTYPE:

            return"contentType";

        case ATTRIBUTEVALUE_MASK_UNSTRUCTUREDNAME:

            return"unstructuredName";

        case ATTRIBUTEVALUE_MASK_MESSAGEDIGEST:

            return"messageDigest";

        case ATTRIBUTEVALUE_MASK_SIGNINGTIME:

            return"signingTime";

        case ATTRIBUTEVALUE_MASK_CHALLENGEPASSWORD:

            return"challengePassword";

        case ATTRIBUTEVALUE_MASK_UNSTRUCTUREDADDRESS:

            return"unstructuredAddress";

        case ATTRIBUTEVALUE_MASK_BMPSTRING:

            return"bmpString";

        case ATTRIBUTEVALUE_MASK_X520NAME:

            return"x520Name";

        case ATTRIBUTEVALUE_MASK_X520COMMONNAME:

            return"x520CommonName";

        case ATTRIBUTEVALUE_MASK_SIGNERINFO:

            return"signerInfo";

        case ATTRIBUTEVALUE_MASK_PKCS9LOCALKEYID:

            return"pkcs9LocalKeyID";

        case ATTRIBUTEVALUE_MASK_KEYUSAGE:

            return"keyUsage";

        case ATTRIBUTEVALUE_MASK_UTF8STRING:

            return"utf8String";

        case ATTRIBUTEVALUE_MASK_GENDERSTRING:

            return"genderString";

        case ATTRIBUTEVALUE_MASK_PRINTABLECOUNTRYNAME:

            return"printableCountryName";

        case ATTRIBUTEVALUE_MASK_LOCALITYNAME:

            return"localityName";

        case ATTRIBUTEVALUE_MASK_DOMAINCOMPONENT:

            return"domainComponent";

        case ATTRIBUTEVALUE_MASK_T61STRING:

            return"t61String";

        case ATTRIBUTEVALUE_MASK_EXTENSIONS:

            return"extensions";

        case ATTRIBUTEVALUE_MASK_STREETADDRESS:

            return"streetAddress";
    }

#endif

    return "";

}

PANSC_ATTR_OBJECT
AnscAsn1AttributeValueCreateSelectionAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(selType);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

LONG
AnscAsn1AttributeValueGetChoiceByOID
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pOIDString
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    if( pOIDString == NULL)         return -1;

    if( AnscEqualString1(pOIDString,"2.5.4.41",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520NAME;
    }
    else if( AnscEqualString1(pOIDString,"2.5.4.42",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520NAME;
    }
    else if( AnscEqualString1(pOIDString,"2.5.4.43",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520NAME;
    }
    else if( AnscEqualString1(pOIDString,"2.5.4.44",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520NAME;
    }
    else if( AnscEqualString1(pOIDString,"2.5.4.4",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520NAME;
    }
    else if( AnscEqualString1(pOIDString,"2.5.4.3",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520COMMONNAME;
    }
    else if( AnscEqualString1(pOIDString,"2.5.4.10",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520COMMONNAME;
    }
    else if( AnscEqualString1(pOIDString,"2.5.4.11",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520COMMONNAME;
    }
    else if( AnscEqualString1(pOIDString,"2.5.4.12",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520COMMONNAME;
    }
    else if( AnscEqualString1(pOIDString,"2.5.4.7",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_LOCALITYNAME;
    }
    else if( AnscEqualString1(pOIDString,"2.5.4.8",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_LOCALITYNAME;
    }
    else if( AnscEqualString1(pOIDString,"2.5.4.9",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_STREETADDRESS;
    }
    else if( AnscEqualString1(pOIDString,"2.5.4.5",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520DNQUALIFIER;
    }
    else if( AnscEqualString1(pOIDString,"2.5.4.6",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_COUNTRYNAME;
    }
    else if( AnscEqualString1(pOIDString,"2.5.4.46",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520DNQUALIFIER;
    }
    else if( AnscEqualString1(pOIDString,"1.2.840.113549.1.9.1",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_PKCS9EMAILADDRESS;
    }
    else if( AnscEqualString1(pOIDString,"1.2.840.113549.1.9.2",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_UNSTRUCTUREDNAME;
    }
    else if( AnscEqualString1(pOIDString,"1.2.840.113549.1.9.3",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_CONTENTTYPE;
    }
    else if( AnscEqualString1(pOIDString,"1.2.840.113549.1.9.4",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_MESSAGEDIGEST;
    }
    else if( AnscEqualString1(pOIDString,"1.2.840.113549.1.9.5",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_SIGNINGTIME;
    }
    else if( AnscEqualString1(pOIDString,"1.2.840.113549.1.9.6",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_SIGNERINFO;
    }
    else if( AnscEqualString1(pOIDString,"1.2.840.113549.1.9.7",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_CHALLENGEPASSWORD;
    }
    else if( AnscEqualString1(pOIDString,"1.2.840.113549.1.9.8",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_UNSTRUCTUREDADDRESS;
    }
    else if( AnscEqualString1(pOIDString,"1.2.840.113549.1.9.20",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_BMPSTRING;
    }
    else if( AnscEqualString1(pOIDString,"1.2.840.113549.1.9.21",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_PKCS9LOCALKEYID;
    }
    else if( AnscEqualString1(pOIDString,"2.5.29.15",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_KEYUSAGE;
    }
    else if( AnscEqualString1(pOIDString,"2.16.840.1.113733.1.9.2",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520NAME;
    }
    else if( AnscEqualString1(pOIDString,"2.16.840.1.113733.1.9.3",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520NAME;
    }
    else if( AnscEqualString1(pOIDString,"2.16.840.1.113733.1.9.4",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520NAME;
    }
    else if( AnscEqualString1(pOIDString,"2.16.840.1.113733.1.9.5",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520NAME;
    }
    else if( AnscEqualString1(pOIDString,"2.16.840.1.113733.1.9.6",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520NAME;
    }
    else if( AnscEqualString1(pOIDString,"2.16.840.1.113733.1.9.7",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520NAME;
    }
    else if( AnscEqualString1(pOIDString,"2.16.840.1.113733.1.9.8",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520NAME;
    }
    else if( AnscEqualString1(pOIDString,"1.3.6.1.5.5.7.5.2.1",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_UTF8STRING;
    }
    else if( AnscEqualString1(pOIDString,"1.3.6.1.5.5.7.9.1",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_SIGNINGTIME;
    }
    else if( AnscEqualString1(pOIDString,"1.3.6.1.5.5.7.9.2",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_X520NAME;
    }
    else if( AnscEqualString1(pOIDString,"1.3.6.1.5.5.7.9.3",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_GENDERSTRING;
    }
    else if( AnscEqualString1(pOIDString,"1.3.6.1.5.5.7.9.4",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_PRINTABLECOUNTRYNAME;
    }
    else if( AnscEqualString1(pOIDString,"1.3.6.1.5.5.7.9.5",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_PRINTABLECOUNTRYNAME;
    }
    else if( AnscEqualString1(pOIDString,"0.9.2342.19200300.100.1.25",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_DOMAINCOMPONENT;
    }
    else if( AnscEqualString1(pOIDString,"0.9.2342.19200300.100.1.1",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_DOMAINCOMPONENT;
    }
    else if( AnscEqualString1(pOIDString,"0.9.2342.19200300.100.1.3",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_T61STRING;
    }
    else if( AnscEqualString1(pOIDString,"1.2.840.113549.1.9.14",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_EXTENSIONS;
    }
    else if( AnscEqualString1(pOIDString,"1.3.6.1.4.1.311.17.1",FALSE))
    {
        return ATTRIBUTEVALUE_MASK_BMPSTRING;
    }   

    return -1;

}

PCHAR
AnscAsn1AttributeValueGetOIDValueByMask
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( selType )
    {
        case ATTRIBUTEVALUE_MASK_X520NAME:

             return "2.5.4.41";

        /*
        case ATTRIBUTEVALUE_MASK_X520NAME:

             return "2.5.4.42";
        */

        /*
        case ATTRIBUTEVALUE_MASK_X520NAME:

             return "2.5.4.43";
        */

        /*
        case ATTRIBUTEVALUE_MASK_X520NAME:

             return "2.5.4.44";
        */

        case ATTRIBUTEVALUE_MASK_X520COMMONNAME:

             return "2.5.4.3";

        /*
        case ATTRIBUTEVALUE_MASK_X520NAME:

             return "2.5.4.4";
        */

        case ATTRIBUTEVALUE_MASK_STREETADDRESS:

             return "2.5.4.9";

        /*
        case ATTRIBUTEVALUE_MASK_X520COMMONNAME:

             return "2.5.4.10";
        */

        /*
        case ATTRIBUTEVALUE_MASK_X520COMMONNAME:

             return "2.5.4.11";
        */

        /*
        case ATTRIBUTEVALUE_MASK_X520COMMONNAME:

             return "2.5.4.12";
        */

        case ATTRIBUTEVALUE_MASK_LOCALITYNAME:

             return "2.5.4.7";

        /*
        case ATTRIBUTEVALUE_MASK_LOCALITYNAME:

             return "2.5.4.8";
        */

        case ATTRIBUTEVALUE_MASK_X520DNQUALIFIER:

             return "2.5.4.5";

        case ATTRIBUTEVALUE_MASK_COUNTRYNAME:

             return "2.5.4.6";

        /*
        case ATTRIBUTEVALUE_MASK_X520DNQUALIFIER:

             return "2.5.4.46";
        */

        case ATTRIBUTEVALUE_MASK_PKCS9EMAILADDRESS:

             return "1.2.840.113549.1.9.1";

        case ATTRIBUTEVALUE_MASK_UNSTRUCTUREDNAME:

             return "1.2.840.113549.1.9.2";

        case ATTRIBUTEVALUE_MASK_CONTENTTYPE:

             return "1.2.840.113549.1.9.3";

        case ATTRIBUTEVALUE_MASK_MESSAGEDIGEST:

             return "1.2.840.113549.1.9.4";

        case ATTRIBUTEVALUE_MASK_SIGNINGTIME:

             return "1.2.840.113549.1.9.5";

        case ATTRIBUTEVALUE_MASK_SIGNERINFO:

             return "1.2.840.113549.1.9.6";

        case ATTRIBUTEVALUE_MASK_CHALLENGEPASSWORD:

             return "1.2.840.113549.1.9.7";

        case ATTRIBUTEVALUE_MASK_UNSTRUCTUREDADDRESS:

             return "1.2.840.113549.1.9.8";

        case ATTRIBUTEVALUE_MASK_BMPSTRING:

             return "1.2.840.113549.1.9.20";

        case ATTRIBUTEVALUE_MASK_PKCS9LOCALKEYID:

             return "1.2.840.113549.1.9.21";

        case ATTRIBUTEVALUE_MASK_KEYUSAGE:

             return "2.5.29.15";

        /*
        case ATTRIBUTEVALUE_MASK_X520NAME:

             return "2.16.840.1.113733.1.9.2";
        */

        /*
        case ATTRIBUTEVALUE_MASK_X520NAME:

             return "2.16.840.1.113733.1.9.3";
        */

        /*
        case ATTRIBUTEVALUE_MASK_X520NAME:

             return "2.16.840.1.113733.1.9.4";
        */

        /*
        case ATTRIBUTEVALUE_MASK_X520NAME:

             return "2.16.840.1.113733.1.9.5";
        */

        /*
        case ATTRIBUTEVALUE_MASK_X520NAME:

             return "2.16.840.1.113733.1.9.6";
        */

        /*
        case ATTRIBUTEVALUE_MASK_X520NAME:

             return "2.16.840.1.113733.1.9.7";
        */

        /*
        case ATTRIBUTEVALUE_MASK_X520NAME:

             return "2.16.840.1.113733.1.9.8";
        */

        case ATTRIBUTEVALUE_MASK_UTF8STRING:

             return "1.3.6.1.5.5.7.5.2.1";

        /*
        case ATTRIBUTEVALUE_MASK_SIGNINGTIME:

             return "1.3.6.1.5.5.7.9.1";
        */

        /*
        case ATTRIBUTEVALUE_MASK_X520NAME:

             return "1.3.6.1.5.5.7.9.2";
        */

        case ATTRIBUTEVALUE_MASK_GENDERSTRING:

             return "1.3.6.1.5.5.7.9.3";

        case ATTRIBUTEVALUE_MASK_PRINTABLECOUNTRYNAME:

             return "1.3.6.1.5.5.7.9.4";

        /*
        case ATTRIBUTEVALUE_MASK_PRINTABLECOUNTRYNAME:

             return "1.3.6.1.5.5.7.9.5";
        */

        case ATTRIBUTEVALUE_MASK_DOMAINCOMPONENT:

             return "0.9.2342.19200300.100.1.25";

        /*
        case ATTRIBUTEVALUE_MASK_DOMAINCOMPONENT:

             return "0.9.2342.19200300.100.1.1";
        */

        case ATTRIBUTEVALUE_MASK_T61STRING:

             return "0.9.2342.19200300.100.1.3";

        case ATTRIBUTEVALUE_MASK_EXTENSIONS:

             return "1.2.840.113549.1.9.14";
    }

    return NULL;

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_X520NAME

 X520name ::= Choice 
     {
                     teletexString TeletexString 
                   printableString PrintableString 
                   universalString UniversalString 
                        utf8String UTF8String 
                         bmpString BMPString 
                       octetString OctetString 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateX520name
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_X520NAME             pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    if( hReserved != NULL)
    {
        pThisObject = (PANSC_ASN1_X520NAME)
            AnscAsn1CreateChoice
                (
                    hReserved
                );
    }
    else
    {
        pThisObject = (PANSC_ASN1_X520NAME)
            AnscAsn1CreateChoice
                (
                    (ANSC_HANDLE)sizeof(ANSC_ASN1_X520NAME)
                );
    }

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_X520NAME");
    pThisObject->SetName(pThisObject, "X520name");

    pThisObject->Create             = AnscAsn1CreateX520name;
    pThisObject->CreateSelection    = AnscAsn1X520nameCreateSelection;
    pThisObject->GetSelectionName   = AnscAsn1X520nameGetSelectionName;
    pThisObject->CreateSelectionAttr= AnscAsn1X520nameCreateSelectionAttr;
    pThisObject->GetChoiceTagValue  = AnscAsn1X520nameGetChoiceTagValue;
    pThisObject->uTotalChoice       = X520NAME_MAXI_MASK + 1;
    pThisObject->bChoiceByOID       = FALSE;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1X520nameCreateSelection
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_CHOICE               pParent         = (PANSC_ASN1_CHOICE)hThisObject;

    switch( index )
    {

        case X520NAME_MASK_TELETEXSTRING:

            pThisObject = AnscAsn1CreateTeletexString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case X520NAME_MASK_PRINTABLESTRING:

            pThisObject = AnscAsn1CreatePrintableString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case X520NAME_MASK_UNIVERSALSTRING:

            pThisObject = AnscAsn1CreateUniversalString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case X520NAME_MASK_UTF8STRING:

            pThisObject = AnscAsn1CreateUTF8String(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case X520NAME_MASK_BMPSTRING:

            pThisObject = AnscAsn1CreateBMPString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case X520NAME_MASK_OCTETSTRING:

            pThisObject = AnscAsn1CreateOctetString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PCHAR
AnscAsn1X520nameGetSelectionName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( selType )
    {
        case X520NAME_MASK_TELETEXSTRING:

            return"teletexString";

        case X520NAME_MASK_PRINTABLESTRING:

            return"printableString";

        case X520NAME_MASK_UNIVERSALSTRING:

            return"universalString";

        case X520NAME_MASK_UTF8STRING:

            return"utf8String";

        case X520NAME_MASK_BMPSTRING:

            return"bmpString";

        case X520NAME_MASK_OCTETSTRING:

            return"octetString";

    }
    return "";

}

PANSC_ATTR_OBJECT
AnscAsn1X520nameCreateSelectionAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(selType);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

BOOLEAN
AnscAsn1X520nameGetChoiceTagValue
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       uIndex,
        PASN_OBJECT_FORM_TYPE       pAttr,
        PULONG                      pTagValue
    )
{
   UNREFERENCED_PARAMETER(hThisObject);
   if( pAttr == NULL || pTagValue == NULL)
    {
        return FALSE;
    }

    switch ( uIndex )
    {
        case X520NAME_MASK_TELETEXSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x14;

            return TRUE;

        case X520NAME_MASK_PRINTABLESTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x13;

            return TRUE;

        case X520NAME_MASK_UNIVERSALSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x1C;

            return TRUE;

        case X520NAME_MASK_UTF8STRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x0C;

            return TRUE;

        case X520NAME_MASK_BMPSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x1D;

            return TRUE;

        case X520NAME_MASK_OCTETSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x04;

            return TRUE;

    }

    return FALSE;

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_UNSTRUCTUREDNAME

 UnstructuredName ::= Choice 
     {
                         iA5String IA5String 
                   universalString UniversalString 
                   printableString PrintableString 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateUnstructuredName
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_UNSTRUCTUREDNAME     pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    if( hReserved != NULL)
    {
        pThisObject = (PANSC_ASN1_UNSTRUCTUREDNAME)
            AnscAsn1CreateChoice
                (
                    hReserved
                );
    }
    else
    {
        pThisObject = (PANSC_ASN1_UNSTRUCTUREDNAME)
            AnscAsn1CreateChoice
                (
                    (ANSC_HANDLE)sizeof(ANSC_ASN1_UNSTRUCTUREDNAME)
                );
    }

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_UNSTRUCTUREDNAME");
    pThisObject->SetName(pThisObject, "UnstructuredName");

    pThisObject->Create             = AnscAsn1CreateUnstructuredName;
    pThisObject->CreateSelection    = AnscAsn1UnstructuredNameCreateSelection;
    pThisObject->GetSelectionName   = AnscAsn1UnstructuredNameGetSelectionName;
    pThisObject->CreateSelectionAttr= AnscAsn1UnstructuredNameCreateSelectionAttr;
    pThisObject->GetChoiceTagValue  = AnscAsn1UnstructuredNameGetChoiceTagValue;
    pThisObject->uTotalChoice       = UNSTRUCTUREDNAME_MAXI_MASK + 1;
    pThisObject->bChoiceByOID       = FALSE;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1UnstructuredNameCreateSelection
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_CHOICE               pParent         = (PANSC_ASN1_CHOICE)hThisObject;

    switch( index )
    {

        case UNSTRUCTUREDNAME_MASK_IA5STRING:

            pThisObject = AnscAsn1CreateIA5String(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case UNSTRUCTUREDNAME_MASK_UNIVERSALSTRING:

            pThisObject = AnscAsn1CreateUniversalString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case UNSTRUCTUREDNAME_MASK_PRINTABLESTRING:

            pThisObject = AnscAsn1CreatePrintableString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PCHAR
AnscAsn1UnstructuredNameGetSelectionName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
     switch ( selType )
    {
        case UNSTRUCTUREDNAME_MASK_IA5STRING:

            return"iA5String";

        case UNSTRUCTUREDNAME_MASK_UNIVERSALSTRING:

            return"universalString";

        case UNSTRUCTUREDNAME_MASK_PRINTABLESTRING:

            return"printableString";

    }
    return "";

}

PANSC_ATTR_OBJECT
AnscAsn1UnstructuredNameCreateSelectionAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(selType);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

BOOLEAN
AnscAsn1UnstructuredNameGetChoiceTagValue
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       uIndex,
        PASN_OBJECT_FORM_TYPE       pAttr,
        PULONG                      pTagValue
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    if( pAttr == NULL || pTagValue == NULL)
    {
        return FALSE;
    }

    switch ( uIndex )
    {
        case UNSTRUCTUREDNAME_MASK_IA5STRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x16;

            return TRUE;

        case UNSTRUCTUREDNAME_MASK_UNIVERSALSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x1C;

            return TRUE;

        case UNSTRUCTUREDNAME_MASK_PRINTABLESTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x13;

            return TRUE;

    }

    return FALSE;

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_DIRECTORYSTRING

 DirectoryString ::= Choice 
     {
                     teletexString TeletexString 
                   printableString PrintableString 
                   universalString UniversalString 
                        utf8String UTF8String 
                         bmpString BMPString 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateDirectoryString
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_DIRECTORYSTRING      pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    if( hReserved != NULL)
    {
        pThisObject = (PANSC_ASN1_DIRECTORYSTRING)
            AnscAsn1CreateChoice
                (
                    hReserved
                );
    }
    else
    {
        pThisObject = (PANSC_ASN1_DIRECTORYSTRING)
            AnscAsn1CreateChoice
                (
                    (ANSC_HANDLE)sizeof(ANSC_ASN1_DIRECTORYSTRING)
                );
    }

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_DIRECTORYSTRING");
    pThisObject->SetName(pThisObject, "DirectoryString");

    pThisObject->Create             = AnscAsn1CreateDirectoryString;
    pThisObject->CreateSelection    = AnscAsn1DirectoryStringCreateSelection;
    pThisObject->GetSelectionName   = AnscAsn1DirectoryStringGetSelectionName;
    pThisObject->CreateSelectionAttr= AnscAsn1DirectoryStringCreateSelectionAttr;
    pThisObject->GetChoiceTagValue  = AnscAsn1DirectoryStringGetChoiceTagValue;
    pThisObject->uTotalChoice       = DIRECTORYSTRING_MAXI_MASK + 1;
    pThisObject->bChoiceByOID       = FALSE;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1DirectoryStringCreateSelection
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_CHOICE               pParent         = (PANSC_ASN1_CHOICE)hThisObject;

    switch( index )
    {

        case DIRECTORYSTRING_MASK_TELETEXSTRING:

            pThisObject = AnscAsn1CreateTeletexString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case DIRECTORYSTRING_MASK_PRINTABLESTRING:

            pThisObject = AnscAsn1CreatePrintableString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case DIRECTORYSTRING_MASK_UNIVERSALSTRING:

            pThisObject = AnscAsn1CreateUniversalString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case DIRECTORYSTRING_MASK_UTF8STRING:

            pThisObject = AnscAsn1CreateUTF8String(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case DIRECTORYSTRING_MASK_BMPSTRING:

            pThisObject = AnscAsn1CreateBMPString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PCHAR
AnscAsn1DirectoryStringGetSelectionName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( selType )
    {
        case DIRECTORYSTRING_MASK_TELETEXSTRING:

            return"teletexString";

        case DIRECTORYSTRING_MASK_PRINTABLESTRING:

            return"printableString";

        case DIRECTORYSTRING_MASK_UNIVERSALSTRING:

            return"universalString";

        case DIRECTORYSTRING_MASK_UTF8STRING:

            return"utf8String";

        case DIRECTORYSTRING_MASK_BMPSTRING:

            return"bmpString";

    }
    return "";

}

PANSC_ATTR_OBJECT
AnscAsn1DirectoryStringCreateSelectionAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(selType);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

BOOLEAN
AnscAsn1DirectoryStringGetChoiceTagValue
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       uIndex,
        PASN_OBJECT_FORM_TYPE       pAttr,
        PULONG                      pTagValue
    )
{
   UNREFERENCED_PARAMETER(hThisObject);
   if( pAttr == NULL || pTagValue == NULL)
    {
        return FALSE;
    }

    switch ( uIndex )
    {
        case DIRECTORYSTRING_MASK_TELETEXSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x14;

            return TRUE;

        case DIRECTORYSTRING_MASK_PRINTABLESTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x13;

            return TRUE;

        case DIRECTORYSTRING_MASK_UNIVERSALSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x1C;

            return TRUE;

        case DIRECTORYSTRING_MASK_UTF8STRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x0C;

            return TRUE;

        case DIRECTORYSTRING_MASK_BMPSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x1D;

            return TRUE;

    }

    return FALSE;

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_MESSAGEDIGEST

 MessageDigest ::= OctetString 

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateMessageDigest
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_MESSAGEDIGEST        pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    if( hReserved != NULL)
    {
        pThisObject = (PANSC_ASN1_MESSAGEDIGEST)
            AnscAsn1CreateOctetString
                (
                    hReserved
                );
    }
    else
    {
        pThisObject = (PANSC_ASN1_MESSAGEDIGEST)
            AnscAsn1CreateOctetString
                (
                    (ANSC_HANDLE)sizeof(ANSC_ASN1_MESSAGEDIGEST)
                );
    }

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_MESSAGEDIGEST");
    pThisObject->SetName(pThisObject, "MessageDigest");

    pThisObject->Create             = AnscAsn1CreateMessageDigest;

    return (ANSC_HANDLE)pThisObject;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_SIGNINGTIME

 SigningTime ::= Time 

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateSigningTime
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_SIGNINGTIME          pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    if( hReserved != NULL)
    {
        pThisObject = (PANSC_ASN1_SIGNINGTIME)
            AnscAsn1CreateTime
                (
                    hReserved
                );
    }
    else
    {
        pThisObject = (PANSC_ASN1_SIGNINGTIME)
            AnscAsn1CreateTime
                (
                    (ANSC_HANDLE)sizeof(ANSC_ASN1_SIGNINGTIME)
                );
    }

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_SIGNINGTIME");
    pThisObject->SetName(pThisObject, "SigningTime");

    pThisObject->Create             = AnscAsn1CreateSigningTime;

    return (ANSC_HANDLE)pThisObject;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_CHLLENGEPASSWORD

 ChllengePassword ::= Choice 
     {
                   printableString PrintableString 
                         t61String TeletexString 
                   universalString UniversalString 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateChllengePassword
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_CHLLENGEPASSWORD     pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    if( hReserved != NULL)
    {
        pThisObject = (PANSC_ASN1_CHLLENGEPASSWORD)
            AnscAsn1CreateChoice
                (
                    hReserved
                );
    }
    else
    {
        pThisObject = (PANSC_ASN1_CHLLENGEPASSWORD)
            AnscAsn1CreateChoice
                (
                    (ANSC_HANDLE)sizeof(ANSC_ASN1_CHLLENGEPASSWORD)
                );
    }

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_CHLLENGEPASSWORD");
    pThisObject->SetName(pThisObject, "ChllengePassword");

    pThisObject->Create             = AnscAsn1CreateChllengePassword;
    pThisObject->CreateSelection    = AnscAsn1ChllengePasswordCreateSelection;
    pThisObject->GetSelectionName   = AnscAsn1ChllengePasswordGetSelectionName;
    pThisObject->CreateSelectionAttr= AnscAsn1ChllengePasswordCreateSelectionAttr;
    pThisObject->GetChoiceTagValue  = AnscAsn1ChllengePasswordGetChoiceTagValue;
    pThisObject->uTotalChoice       = CHLLENGEPASSWORD_MAXI_MASK + 1;
    pThisObject->bChoiceByOID       = FALSE;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1ChllengePasswordCreateSelection
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_CHOICE               pParent         = (PANSC_ASN1_CHOICE)hThisObject;

    switch( index )
    {

        case CHLLENGEPASSWORD_MASK_PRINTABLESTRING:

            pThisObject = AnscAsn1CreatePrintableString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case CHLLENGEPASSWORD_MASK_T61STRING:

            pThisObject = AnscAsn1CreateTeletexString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case CHLLENGEPASSWORD_MASK_UNIVERSALSTRING:

            pThisObject = AnscAsn1CreateUniversalString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PCHAR
AnscAsn1ChllengePasswordGetSelectionName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( selType )
    {
        case CHLLENGEPASSWORD_MASK_PRINTABLESTRING:

            return"printableString";

        case CHLLENGEPASSWORD_MASK_T61STRING:

            return"t61String";

        case CHLLENGEPASSWORD_MASK_UNIVERSALSTRING:

            return"universalString";

    }

    return "";

}

PANSC_ATTR_OBJECT
AnscAsn1ChllengePasswordCreateSelectionAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(selType);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

BOOLEAN
AnscAsn1ChllengePasswordGetChoiceTagValue
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       uIndex,
        PASN_OBJECT_FORM_TYPE       pAttr,
        PULONG                      pTagValue
    )
{
   UNREFERENCED_PARAMETER(hThisObject);
   if( pAttr == NULL || pTagValue == NULL)
    {
        return FALSE;
    }

    switch ( uIndex )
    {
        case CHLLENGEPASSWORD_MASK_PRINTABLESTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x13;

            return TRUE;

        case CHLLENGEPASSWORD_MASK_T61STRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x14;

            return TRUE;

        case CHLLENGEPASSWORD_MASK_UNIVERSALSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x1C;

            return TRUE;

    }

    return FALSE;

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_UNSTRUCTUREDADDRESS

 UnstructuredAddress ::= Choice 
     {
                   printableString PrintableString 
                         t61String TeletexString 
                   universalString UniversalString 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateUnstructuredAddress
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_UNSTRUCTUREDADDRESS  pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    if( hReserved != NULL)
    {
        pThisObject = (PANSC_ASN1_UNSTRUCTUREDADDRESS)
            AnscAsn1CreateChoice
                (
                    hReserved
                );
    }
    else
    {
        pThisObject = (PANSC_ASN1_UNSTRUCTUREDADDRESS)
            AnscAsn1CreateChoice
                (
                    (ANSC_HANDLE)sizeof(ANSC_ASN1_UNSTRUCTUREDADDRESS)
                );
    }

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_UNSTRUCTUREDADDRESS");
    pThisObject->SetName(pThisObject, "UnstructuredAddress");

    pThisObject->Create             = AnscAsn1CreateUnstructuredAddress;
    pThisObject->CreateSelection    = AnscAsn1UnstructuredAddressCreateSelection;
    pThisObject->GetSelectionName   = AnscAsn1UnstructuredAddressGetSelectionName;
    pThisObject->CreateSelectionAttr= AnscAsn1UnstructuredAddressCreateSelectionAttr;
    pThisObject->GetChoiceTagValue  = AnscAsn1UnstructuredAddressGetChoiceTagValue;
    pThisObject->uTotalChoice       = UNSTRUCTUREDADDRESS_MAXI_MASK + 1;
    pThisObject->bChoiceByOID       = FALSE;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1UnstructuredAddressCreateSelection
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_CHOICE               pParent         = (PANSC_ASN1_CHOICE)hThisObject;

    switch( index )
    {

        case UNSTRUCTUREDADDRESS_MASK_PRINTABLESTRING:

            pThisObject = AnscAsn1CreatePrintableString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case UNSTRUCTUREDADDRESS_MASK_T61STRING:

            pThisObject = AnscAsn1CreateTeletexString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case UNSTRUCTUREDADDRESS_MASK_UNIVERSALSTRING:

            pThisObject = AnscAsn1CreateUniversalString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PCHAR
AnscAsn1UnstructuredAddressGetSelectionName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( selType )
    {
        case UNSTRUCTUREDADDRESS_MASK_PRINTABLESTRING:

            return"printableString";

        case UNSTRUCTUREDADDRESS_MASK_T61STRING:

            return"t61String";

        case UNSTRUCTUREDADDRESS_MASK_UNIVERSALSTRING:

            return"universalString";

    }

    return "";

}

PANSC_ATTR_OBJECT
AnscAsn1UnstructuredAddressCreateSelectionAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(selType);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

BOOLEAN
AnscAsn1UnstructuredAddressGetChoiceTagValue
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       uIndex,
        PASN_OBJECT_FORM_TYPE       pAttr,
        PULONG                      pTagValue
    )
{
   UNREFERENCED_PARAMETER(hThisObject);
   if( pAttr == NULL || pTagValue == NULL)
    {
        return FALSE;
    }

    switch ( uIndex )
    {
        case UNSTRUCTUREDADDRESS_MASK_PRINTABLESTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x13;

            return TRUE;

        case UNSTRUCTUREDADDRESS_MASK_T61STRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x14;

            return TRUE;

        case UNSTRUCTUREDADDRESS_MASK_UNIVERSALSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x1C;

            return TRUE;

    }

    return FALSE;

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_CONTENTTYPE

 ContentType ::= OID 

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateContentType
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_CONTENTTYPE          pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_CONTENTTYPE)
        AnscAsn1CreateOID
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_CONTENTTYPE");
    pThisObject->SetName(pThisObject, "ContentType");

    pThisObject->Create             = AnscAsn1CreateContentType;

    return (ANSC_HANDLE)pThisObject;
}

/**********************************************************************

 OBJECT -- ANSC_ASN1_X520COMMONNAME

 X520CommonName ::= Choice 
     {
                     teletexString TeletexString 
                   printableString PrintableString 
                   universalString UniversalString 
                        utf8String UTF8String 
                         bmpString BMPString 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateX520CommonName
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_X520COMMONNAME       pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_X520COMMONNAME)
        AnscAsn1CreateChoice
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_X520COMMONNAME");
    pThisObject->SetName(pThisObject, "X520CommonName");

    pThisObject->Create             = AnscAsn1CreateX520CommonName;
    pThisObject->CreateSelection    = AnscAsn1X520CommonNameCreateSelection;
    pThisObject->GetSelectionName   = AnscAsn1X520CommonNameGetSelectionName;
    pThisObject->CreateSelectionAttr= AnscAsn1X520CommonNameCreateSelectionAttr;
    pThisObject->GetChoiceTagValue  = AnscAsn1X520CommonNameGetChoiceTagValue;
    pThisObject->uTotalChoice       = X520COMMONNAME_MAXI_MASK + 1;
    pThisObject->bChoiceByOID       = FALSE;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1X520CommonNameCreateSelection
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_CHOICE               pParent         = (PANSC_ASN1_CHOICE)hThisObject;

    switch( index )
    {

        case X520COMMONNAME_MASK_TELETEXSTRING:

            pThisObject = AnscAsn1CreateTeletexString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case X520COMMONNAME_MASK_PRINTABLESTRING:

            pThisObject = AnscAsn1CreatePrintableString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case X520COMMONNAME_MASK_UNIVERSALSTRING:

            pThisObject = AnscAsn1CreateUniversalString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case X520COMMONNAME_MASK_UTF8STRING:

            pThisObject = AnscAsn1CreateUTF8String(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case X520COMMONNAME_MASK_BMPSTRING:

            pThisObject = AnscAsn1CreateBMPString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PCHAR
AnscAsn1X520CommonNameGetSelectionName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( selType )
    {
        case X520COMMONNAME_MASK_TELETEXSTRING:

            return"teletexString";

        case X520COMMONNAME_MASK_PRINTABLESTRING:

            return"printableString";

        case X520COMMONNAME_MASK_UNIVERSALSTRING:

            return"universalString";

        case X520COMMONNAME_MASK_UTF8STRING:

            return"utf8String";

        case X520COMMONNAME_MASK_BMPSTRING:

            return"bmpString";

    }
    return "";

}

PANSC_ATTR_OBJECT
AnscAsn1X520CommonNameCreateSelectionAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    UNREFERENCED_PARAMETER(selType);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

BOOLEAN
AnscAsn1X520CommonNameGetChoiceTagValue
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       uIndex,
        PASN_OBJECT_FORM_TYPE       pAttr,
        PULONG                      pTagValue
    )
{
   UNREFERENCED_PARAMETER(hThisObject);
   if( pAttr == NULL || pTagValue == NULL)
    {
        return FALSE;
    }

    switch ( uIndex )
    {
        case X520COMMONNAME_MASK_TELETEXSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x14;

            return TRUE;

        case X520COMMONNAME_MASK_PRINTABLESTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x13;

            return TRUE;

        case X520COMMONNAME_MASK_UNIVERSALSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x1C;

            return TRUE;

        case X520COMMONNAME_MASK_UTF8STRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x0C;

            return TRUE;

        case X520COMMONNAME_MASK_BMPSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x1D;

            return TRUE;

    }

    return FALSE;

}

/**********************************************************************

 OBJECT -- ANSC_ASN1_X520LOCALITYNAME

 X520LocalityName ::= Choice 
     {
                     teletexString TeletexString 
                   printableString PrintableString 
                   universalString UniversalString 
                        utf8String UTF8String 
                         bmpString BMPString 
     }

 **********************************************************************/

ANSC_HANDLE 
AnscAsn1CreateX520LocalityName
    (
        ANSC_HANDLE                 hReserved
    )
{
    PANSC_ASN1_X520LOCALITYNAME     pThisObject  = NULL;

    /*
     * Create the base ASN.1 object.
     */
    pThisObject = (PANSC_ASN1_X520LOCALITYNAME)
        AnscAsn1CreateChoice
            (
                hReserved
            );

    if( pThisObject == NULL)
    {
        return (ANSC_HANDLE)NULL;
    }

    /*
     * Initialize the common variables and functions for this ASN.1 object.
     */
    pThisObject->SetClassName(pThisObject, "ANSC_ASN1_X520LOCALITYNAME");
    pThisObject->SetName(pThisObject, "X520LocalityName");

    pThisObject->Create             = AnscAsn1CreateX520LocalityName;
    pThisObject->CreateSelection    = AnscAsn1X520LocalityNameCreateSelection;
    pThisObject->GetSelectionName   = AnscAsn1X520LocalityNameGetSelectionName;
    pThisObject->CreateSelectionAttr= AnscAsn1X520LocalityNameCreateSelectionAttr;
    pThisObject->GetChoiceTagValue  = AnscAsn1X520LocalityNameGetChoiceTagValue;
    pThisObject->uTotalChoice       = X520LOCALITYNAME_MAXI_MASK + 1;
    pThisObject->bChoiceByOID       = FALSE;

    return (ANSC_HANDLE)pThisObject;
}

ANSC_HANDLE
AnscAsn1X520LocalityNameCreateSelection
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       index
    )
{
    PANSC_ASN1_OBJECT               pThisObject      = NULL;
    PANSC_ASN1_CHOICE               pParent         = (PANSC_ASN1_CHOICE)hThisObject;

    switch( index )
    {

        case X520LOCALITYNAME_MASK_TELETEXSTRING:

            pThisObject = AnscAsn1CreateTeletexString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case X520LOCALITYNAME_MASK_PRINTABLESTRING:

            pThisObject = AnscAsn1CreatePrintableString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case X520LOCALITYNAME_MASK_UNIVERSALSTRING:

            pThisObject = AnscAsn1CreateUniversalString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case X520LOCALITYNAME_MASK_UTF8STRING:

            pThisObject = AnscAsn1CreateUTF8String(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

        case X520LOCALITYNAME_MASK_BMPSTRING:

            pThisObject = AnscAsn1CreateBMPString(NULL);

            if( pThisObject != NULL)
            {
                pThisObject->AddAttribute(pThisObject, pParent->CreateSelectionAttr(pParent,index), FALSE);
                pThisObject->SetName(pThisObject, pParent->GetSelectionName(pParent,index));
            }

            break;

    }

    return pThisObject;

}

PCHAR
AnscAsn1X520LocalityNameGetSelectionName
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
    switch ( selType )
    {
        case X520LOCALITYNAME_MASK_TELETEXSTRING:

            return"teletexString";

        case X520LOCALITYNAME_MASK_PRINTABLESTRING:

            return"printableString";

        case X520LOCALITYNAME_MASK_UNIVERSALSTRING:

            return"universalString";

        case X520LOCALITYNAME_MASK_UTF8STRING:

            return"utf8String";

        case X520LOCALITYNAME_MASK_BMPSTRING:

            return"bmpString";

    }

    return "";

}

PANSC_ATTR_OBJECT
AnscAsn1X520LocalityNameCreateSelectionAttr
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       selType
    )
{
    UNREFERENCED_PARAMETER(hThisObject);
UNREFERENCED_PARAMETER(selType);
    PANSC_ATTR_OBJECT               pAttrObject  = NULL;

    return pAttrObject;

}

BOOLEAN
AnscAsn1X520LocalityNameGetChoiceTagValue
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       uIndex,
        PASN_OBJECT_FORM_TYPE       pAttr,
        PULONG                      pTagValue
    )
{
   UNREFERENCED_PARAMETER(hThisObject);
   if( pAttr == NULL || pTagValue == NULL)
    {
        return FALSE;
    }

    switch ( uIndex )
    {
        case X520LOCALITYNAME_MASK_TELETEXSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x14;

            return TRUE;

        case X520LOCALITYNAME_MASK_PRINTABLESTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x13;

            return TRUE;

        case X520LOCALITYNAME_MASK_UNIVERSALSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x1C;

            return TRUE;

        case X520LOCALITYNAME_MASK_UTF8STRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x0C;

            return TRUE;

        case X520LOCALITYNAME_MASK_BMPSTRING:

            *pAttr       = UNIVERSAL_FORM;
            *pTagValue   = 0x1D;

            return TRUE;

    }

    return FALSE;

}


