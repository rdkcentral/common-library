/*
 * If not stated otherwise in this file or this component's Licenses.txt file the
 * following copyright and licenses apply:
 *
 * Copyright 2015 RDK Management
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
*/

/**********************************************************************
   Copyright [2014] [Cisco Systems, Inc.]
 
   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at
 
       http://www.apache.org/licenses/LICENSE-2.0
 
   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
**********************************************************************/

/**********************************************************************

    MODULE: alcert_internal.h

        ASN.1 ANSC Code Generated by Cisco Systems, Inc.

    ---------------------------------------------------------------

    DESCRIPTION:

        This interface is for the ALCert implementation

    ---------------------------------------------------------------

    ENVIRONMENT:

        platform independent

    ---------------------------------------------------------------

    AUTHOR:

        Bin Zhu

    ---------------------------------------------------------------

    REVISION HISTORY:

        *   09/13/2002  initial revision
        *   11/26/2003  add save/load functions;
        *   11/27/2003  add check cert status function;
        *   12/01/2003  add search ca/entity with name.

 **********************************************************************/


#ifndef  _ALCERT_INTERNAL_H
#define  _ALCERT_INTERNAL_H

/**************************************************************
 *  Remove functions
 ***************************************************************/

ANSC_STATUS
ALCERTRemoveCAEntity
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hEntity,
        BOOLEAN                     bRovIssuedCert
    );

ANSC_STATUS
ALCERTRemoveClientEntity
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hEntity
    );

ANSC_STATUS
ALCERTRemoveCRL
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hEntity
    );

/**************************************************************
 *  Get the total count of 
 ***************************************************************/
ULONG
ALCERTGetCACount
    (
        ANSC_HANDLE                 hThisObject
    );

ULONG
ALCERTGetClientCount
    (
        ANSC_HANDLE                 hThisObject
    );

/**************************************************************
 *  Get the CA cert with given index;
 **************************************************************/
ANSC_HANDLE
ALCERTGetCACertByIndex
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       ulIndex
    );

ANSC_HANDLE
ALCERTGetCAEntityByIndex
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       ulIndex
    );

ANSC_HANDLE
ALCERTGetClientByIndex
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       ulIndex
    );

/**************************************************************
 * 
 * Add subject
 *
 **************************************************************/
ANSC_HANDLE
ALCERTAddSubjectWithCert
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pName,
        PUCHAR                      pCertEncoding,
        ULONG                       certLength,
        PUCHAR                      pKeyEncoding,
        ULONG                       keyLength
    );

ANSC_STATUS
ALCERTAddSubjectEntity
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hClientEntity
    );

ANSC_STATUS
ALCERTSetSubjectCert
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hClientEntity,
        PUCHAR                      pEncoding,
        ULONG                       length
    );

/**************************************************************
 * 
 * Add CA certificate
 *
 **************************************************************/
ANSC_HANDLE
ALCERTAddTrustedCA
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pName,
        PUCHAR                      pEncoding,
        ULONG                       length
    );

ANSC_STATUS
ALCERTAddCRL
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hCAEntity,
        PUCHAR                      pEncoding,
        ULONG                       length
    );

/**************************************************************
 * 
 * searching
 *
 **************************************************************/
ANSC_HANDLE
ALCERTSearchCAEntityByEncoding
    (
        ANSC_HANDLE                 hThisObject,
        PUCHAR                      pEncoding,
        ULONG                       length
    );

ANSC_HANDLE
ALCERTSearchUserByEncoding
    (
        ANSC_HANDLE                 hThisObject,
        PUCHAR                      pEncoding,
        ULONG                       length
    );

ANSC_HANDLE
ALCERTSearchCAByName
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pName
    );

ANSC_HANDLE
ALCERTSearchEntityByName
    (
        ANSC_HANDLE                 hThisObject,
        PCHAR                       pName
    );
        
/**************************************************************
 * 
 * manage functions
 *
 **************************************************************/
ANSC_HANDLE
ALCERTLookforIssuerEntity
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hCert
    );

ANSC_STATUS
ALCERTVerifyCert
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hCert,
        ULONG                       pathIndex
    );

/**************************************************************
 * 
 * Operations 
 *
 **************************************************************/
ANSC_STATUS
ALCERTRemoveAllCAs
    (
        ANSC_HANDLE                 hThisObject
    );

ANSC_STATUS
ALCERTRemoveAllClients
    (
        ANSC_HANDLE                 hThisObject
    );

/**************************************************************
 * 
 * Verify
 *
 **************************************************************/
ANSC_STATUS
ALCERTVerifyCertChain
    (
        ANSC_HANDLE                 hThisObject,
        ULONG                       ulCertPathLength,
        PVOID*                      pCertArray,
        PULONG                      pulCertSizeArray,
        ANSC_HANDLE                 pSubjectID,
        BOOLEAN                     bCheckId,        /* BAKEOF */
        BOOLEAN                     bCheckTime       /* Time is not required for KB5 */
    );

/**************************************************************
 * 
 * acquire the cert path
 *
 **************************************************************/
ANSC_STATUS
ALCERTAcquirePath
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hClientEntity,
        PULONG                      pulCertNumber,
        PVOID*                      pCertArray,
        PULONG                      pulCertSizeArray,
        BOOLEAN                     bIncludeRootCA
    );

/*************************************************************
 *
 *  Get the path length for certain subject entity;
 *
 *************************************************************/
ULONG
ALCERTGetCertChainPath
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hClientEntity
    );

/*************************************************************
 *
 *  Get the CA entity in the certain index of cert chain
 *
 *************************************************************/
ANSC_HANDLE
ALCERTLookforCAInPath
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hClientEntity,
        UINT                        ulIndex
    );

/*************************************************************
 *
 *  Search for the subject entity with the given issuer name
 *
 *************************************************************/
ANSC_HANDLE
ALCERTLookforEntityWithIssuerName
    (
        ANSC_HANDLE                 hThisObject,
        PUCHAR                      pIssuerName,
        ULONG                       length
    );

/*************************************************************
 *
 *  Search for the subject entity with key type
 *
 *************************************************************/
ANSC_HANDLE
ALCERTLookforEntityWithKeyType
    (
        ANSC_HANDLE                 hThisObject,
        PKI_KEY_TYPE                keyType
    );

/*************************************************************
 *
 *  Search for the subject entity with the same pub key
 *
 *************************************************************/
ANSC_HANDLE
ALCERTLookforEntityWithPubKey
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hCert
    );

/*************************************************************
 *
 *  Load/Save functions;
 *
 *************************************************************/
ANSC_STATUS
ALCERTLoad
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hSysStorage
    );

ANSC_STATUS
ALCERTSave
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hSysStorage
    );

/*************************************************************
 *
 *  Check Certificate Status
 *
 *************************************************************/
ULONG
ALCERTGetCertStatus
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hCertHandle
    );

/*************************************************************
 *
 *  Get Name Encoding from Certificate Handle;
 *
 *************************************************************/
ANSC_STATUS 
RetrieveNameEncoding
    (
        PANSC_ASN1_CERTIFICATE      pCert,
        ANSC_HANDLE                 hSubjectID
    );

/*************************************************************
 *
 *  Update CA's CRL
 *
 *************************************************************/
ANSC_STATUS
ALCERTUpdateCACrl
    (
        ANSC_HANDLE                 hThisObject,
        ANSC_HANDLE                 hCAHandle
    );

#endif  /*_ALCERT_INTERNAL_H*/


